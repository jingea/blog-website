
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>ming15</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="ming15">
    

    
    <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="ming15">
<meta property="og:url" content="http://www.ming15.wang/page/16/index.html">
<meta property="og:site_name" content="ming15">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ming15">
<meta name="twitter:description">

    
    <link rel="alternative" href="/atom.xml" title="ming15" type="application/atom+xml">
    
    
    
    <link rel="apple-touch-icon" href="/img/author.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/author.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="ming15" title="ming15"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="ming15">ming15</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/about">关于</a></li>
					
					<li>
 					
						<form class="search" action="http://zhannei.baidu.com/cse/search" target="_blank">
							<label>Search</label>
						<input name="s" type="hidden" value= 17728547076946147000 ><input type="text" name="q" size="30" placeholder="搜索"><br>
						</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/09/21/JavaSE/java网络 URL/" title="Java URL" itemprop="url">Java URL</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-09-20T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-09-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Java支持的传输协议：</p>
<ul>
<li>超文本传输协议: <code>http://www.baidu.com</code>        </li>
<li>安全http协议: <code>https://www.amazon.com/exec/obidos/order2</code></li>
<li>文件传输协议: <code>ftp://metalab.unc.edu/pub/languages/java/javafaq</code></li>
<li>简单邮件传输协议: <code>mailto:elharo@metalab.unc.edu</code></li>
<li>telnet协议: <code>telnet://dibner.poly.edu</code></li>
<li>本地文件访问协议: <code>file:</code></li>
<li>gopher: <code>gopher://gopher.anc.org.za</code></li>
<li>轻量级目录访问协议: <code>ldap://ldap.itd.umich.edu</code></li>
<li>jar: <code>jar://</code></li>
<li>NFS,网络文件协议: <code>nfs://utopia.poly.edu/usr/tmp</code></li>
<li>JDBC 定制协议   通过java.sql包支持: <code>jdbc:mysql://luna.matalab.unc.edu:3306/NEWS</code></li>
<li>rmi  远程方法的调用协议   通过java.rmi包支持: <code>rmi://metalab.unc.edu/RenderEngine</code></li>
<li>HotJava的定制协议: <code>doc:/UserGuide/release.html</code>,<code>netdoc:/UserGuide/release.html</code>, <code>systemresource://www.adc.org/+/index.html</code>, <code>verbatim:http://www.adc.org</code></li>
</ul>
<p>不带端口构造<code>URL</code>(需要注意的是：该构造器生成的URL端口为-1,所以回使用该协议的默认端口   第三个参数加反斜线也是需要注意的)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http"</span> , <span class="string">"www.eff.org"</span>, <span class="string">"/blueribbon.html#intro"</span>);</span><br></pre></td></tr></table></figure></p>
<p>带端口构造<code>URL</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http"</span> , <span class="string">"www.eff.org"</span>, <span class="number">8080</span>, <span class="string">"/blueribbon.html#intro"</span>);</span><br></pre></td></tr></table></figure></p>
<p>根据相对URL和基础URL构建一个绝对URL,当希望迭代处理位于相同目录下的一组文件时, 可以考虑使用该构造器<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http://ibiblio.org/javafaq/index.html"</span>);</span><br><span class="line">URL newURL = <span class="keyword">new</span> URL(url, <span class="string">"mailinglists.html"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"http://ibiblio.org/javafaq/mailinglists.html"</span>, newURL.toString());</span><br></pre></td></tr></table></figure></p>
<p>利用ClassLoader可以加载资源,例如图片 音频等<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = ClassLoader.getSystemResource(<span class="string">"resource/simple.txt"</span>);</span><br><span class="line">Assert.assertEquals(<span class="keyword">null</span>, url);</span><br></pre></td></tr></table></figure></p>
<p>利用ClassLoader可以加载资源,例如图片 音频等<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = getClass().getResource(<span class="string">"resource/simple.txt"</span>);</span><br><span class="line">Assert.assertEquals(<span class="keyword">null</span>, url);</span><br></pre></td></tr></table></figure></p>
<p>查看URL中的模式<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http://ibiblio.org/javafaq/index.html"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"http"</span>, url.getProtocol());</span><br><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http://www.ibiblio.org/javafaq/index.html"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"www.ibiblio.org"</span>, url.getHost());</span><br></pre></td></tr></table></figure></p>
<p>查看URL中的路径 (范围：主机名后面的第一个/ 到片段标示符# 之前) 包含查询字符串<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http://ibiblio.org/nywc/compositions.pthml?category=Piano"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"/nywc/compositions.pthml?category=Piano"</span>, url.getFile());</span><br></pre></td></tr></table></figure></p>
<p>查看URL中的路径 (范围：主机名后面的第一个/ 到片段标示符# 之前)  不包含查询字符串<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http://ibiblio.org/nywc/compositions.pthml?category=Piano"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"/nywc/compositions.pthml"</span>, url.getPath());</span><br></pre></td></tr></table></figure></p>
<p>查看URL中的查询字符串<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"http://ibiblio.org/nywc/compositions.pthml?category=Piano"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"category=Piano"</span>, url.getQuery());</span><br></pre></td></tr></table></figure></p>
<p>查看URL中的查询字符串<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"ftp://mp3:secret@ftp.example.com/c%3a/stuff/mp3"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"mp3:secret"</span>, url.getUserInfo());</span><br></pre></td></tr></table></figure></p>
<p>查看URL中的Authority(授权机构,包含用户信息,主机和端口.一般都回返回主机信息,但是不一定包含用户信息和端口)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">URL url = <span class="keyword">new</span> URL(<span class="string">"ftp://mp3:secret@ftp.example.com/c%3a/stuff/mp3"</span>);</span><br><span class="line">Assert.assertEquals(<span class="string">"mp3:secret@ftp.example.com"</span>, url.getAuthority());</span><br></pre></td></tr></table></figure></p>
<p>sameFile 只是简单的测试url中的主机名是否是别名, 需要更细致的测试, sameFile 与 equals的区别是sameFile不考虑标示符儿equals需要考虑标示符<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">URL u1 = <span class="keyword">new</span> URL(<span class="string">"http://www.ncsa.uiuc.edu/HTMLPrimer.html#GS"</span>);</span><br><span class="line">URL u2 = <span class="keyword">new</span> URL(<span class="string">"http://www.ncsa.uiuc.edu/HTMLPrimer.html#HD"</span>);</span><br><span class="line"><span class="keyword">if</span>(u1.sameFile(u2))</span><br><span class="line">	System.out.println(u1 + <span class="string">" is same file with "</span> + u2);</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">	System.out.println(u1 + <span class="string">" is not same file with "</span> + u2);</span><br></pre></td></tr></table></figure></p>
<p>连接URl所指向的资源.执行客户端和服务器之间任何必要的握手.返回一个可以读取数据的<code>InputStream</code>,该流读取文件里的原始内容,不包括任何HTTP首部或者任何与协议有关的信息<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>(InputStream in = <span class="keyword">new</span> URL(<span class="string">"http://www.baidu.com"</span>).openStream()) &#123;</span><br><span class="line">	<span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>((c = in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span>(c == <span class="string">'&lt;'</span>) System.out.println();</span><br><span class="line">		System.out.write(c);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>openConnection</code>打开指定URL的socket,返回URLConnection对象(一个打开网络资源的连接)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">URLConnection conn = <span class="keyword">new</span> URL(<span class="string">"http://www.baidu.com"</span>).openConnection();</span><br><span class="line"><span class="keyword">try</span>(InputStream in = conn.getInputStream()) &#123;</span><br><span class="line">	<span class="keyword">int</span> c = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>((c = in.read()) != -<span class="number">1</span>) &#123;</span><br><span class="line">		System.out.write(c);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/JavaSE/">JavaSE</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/09/21/JavaSE/java网络 URL/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/09/21/JavaSE/java网络 URL/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/09/20/JavaSE/Java网络 网卡/" title="Java网络接口" itemprop="url">Java网络接口</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-09-19T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-09-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>网络接口的命名</p>
<ul>
<li>eth0: ethernet的简写，一般用于以太网接口。</li>
<li>wifi0:wifi是无线局域网，因此wifi0一般指无线网络接口。</li>
<li>ath0: Atheros的简写，一般指Atheros芯片所包含的无线网络接口。</li>
<li>lo: local的简写，一般指本地环回接口。</li>
</ul>
<p>lo:虚拟网络接口,其并不真实地从外界接收和发送数据包，而是在系统内部接收和发送数据包，因此虚拟网络接口不需要驱动程序硬件网卡的网络接口由驱动程序创建。而虚拟的网络接口由系统创建或通过应用层程序创建。<br>假如包是由一个本地进程为另一个本地进程产生的, 它们将通过外出链的’lo’接口,然后返回进入链的’lo’接口</p>
<p>Java网络接口相关主要用到<code>java.net.NetworkInterface</code>这个类，其表示一个本地IP地址,该类可以是一个物理接口或者绑定于同一个物理接口的虚拟接口.</p>
<p>获取某个名的网络接口对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NetworkInterface net = NetworkInterface.getByName(<span class="string">"eth0"</span>);</span><br></pre></td></tr></table></figure></p>
<p>获取一个绑定于制定ip地址的网络接口对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">InetAddress address = InetAddress.getLocalHost();</span><br><span class="line">NetworkInterface net = NetworkInterface.getByInetAddress(address);</span><br></pre></td></tr></table></figure></p>
<p>列出本机所有的网络接口  包括物理或者虚拟网络接口<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Enumeration&lt;NetworkInterface&gt; nets = NetworkInterface.getNetworkInterfaces();</span><br><span class="line"><span class="keyword">while</span>(nets.hasMoreElements()) &#123;</span><br><span class="line"> System.out.println(<span class="string">"网络接口 ： "</span> + nets.nextElement());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>列出本机所有绑定到该网络接口上的ip地址<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NetworkInterface net = NetworkInterface.getByName(<span class="string">"eth0"</span>);</span><br><span class="line"> Enumeration&lt;InetAddress&gt; address = net.getInetAddresses();</span><br><span class="line"></span><br><span class="line"> <span class="keyword">while</span>(address.hasMoreElements()) &#123;</span><br><span class="line">	 System.out.println(<span class="string">"IP 地址 ： "</span> + address.nextElement());</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.Inet4Address;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.NetworkInterface;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PrintNet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="comment">// 获取全部的网络接口(由操作系统设置,每个硬件网卡(一个MAC)对应一个网络接口)</span></span><br><span class="line">		Enumeration&lt;?&gt; nets = NetworkInterface.getNetworkInterfaces();</span><br><span class="line">		<span class="keyword">while</span> (nets.hasMoreElements()) &#123;</span><br><span class="line">			NetworkInterface net = (NetworkInterface) nets.nextElement();</span><br><span class="line">			printNetworkInterface(net);</span><br><span class="line">			Enumeration&lt;?&gt; addresses = net.getInetAddresses();  <span class="comment">// 返回该接口中所有绑定的ip</span></span><br><span class="line">			System.out.println(<span class="string">"该接口下所有的ip:"</span>);</span><br><span class="line">			<span class="keyword">while</span> (addresses.hasMoreElements()) &#123;</span><br><span class="line">				InetAddress ip = (InetAddress) addresses.nextElement();</span><br><span class="line">                pickUpHosyAddress(ip);</span><br><span class="line">				printInetAddress(ip);</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println();</span><br><span class="line">			System.out.println();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printNetworkInterface</span><span class="params">(NetworkInterface net)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"网络接口的显示名称   :"</span> + net.getDisplayName());</span><br><span class="line">		System.out.println(<span class="string">"网络接口的名称       :"</span> + net.getName());</span><br><span class="line">		System.out.println(<span class="string">"idx                	:"</span> + net.getIndex());</span><br><span class="line">		System.out.println(<span class="string">"最大传输单元         :"</span> + net.getMTU());</span><br><span class="line">		System.out.println(<span class="string">"mac地址              :"</span> + displayMac(net.getHardwareAddress()));</span><br><span class="line">		System.out.println(<span class="string">"是否是回送接口       :"</span> + net.isLoopback());</span><br><span class="line">		System.out.println(<span class="string">"是否是点对点接口     :"</span> + net.isPointToPoint());</span><br><span class="line">		System.out.println(<span class="string">"是否已经开启并运行   :"</span> + net.isUp());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 输出ip地址</span><br><span class="line">	 * <span class="doctag">@param</span> ip</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">pickUpHosyAddress</span><span class="params">(InetAddress ip)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (!ip.isLoopbackAddress() &amp;&amp; !ip.isSiteLocalAddress() &amp;&amp; ip.getHostAddress().indexOf(<span class="string">":"</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"外网 HostAddress   :"</span> + ip.getHostAddress());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (ip.isLoopbackAddress() &amp;&amp; !ip.isSiteLocalAddress() &amp;&amp; ip.getHostAddress().indexOf(<span class="string">":"</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"内网 HostAddress   :"</span> + ip.getHostAddress());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (ip != <span class="keyword">null</span> &amp;&amp; !ip.isLoopbackAddress() &amp;&amp; ip <span class="keyword">instanceof</span> Inet4Address) &#123;</span><br><span class="line">			System.out.println(<span class="string">"HostAddress        :"</span> + ip.getHostAddress());</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * 打印InetAddress 相关信息</span><br><span class="line">	 * <span class="doctag">@param</span> ip</span><br><span class="line">	 * <span class="doctag">@throws</span> Exception</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printInetAddress</span><span class="params">(InetAddress ip)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"远程主机的主机名         :"</span> + ip.getCanonicalHostName());</span><br><span class="line">		System.out.println(<span class="string">"主机地址                 :"</span> + ip.getHostAddress());</span><br><span class="line">		System.out.println(<span class="string">"远程主机的别名           :"</span> + ip.getHostName());</span><br><span class="line">		System.out.println(<span class="string">"mac Address             :"</span> + displayMac(ip.getAddress()));</span><br><span class="line">		System.out.println(<span class="string">"本机主机名               :"</span> + ip.getLocalHost().getHostName());</span><br><span class="line">		System.out.println(<span class="string">"回环地址 主机名          :"</span> + ip.getLoopbackAddress().getHostName());</span><br><span class="line">		<span class="comment">// (127.0.0.0 ~ 127.255.255.255)</span></span><br><span class="line">		System.out.println(<span class="string">"是否是本机的IP地址       :"</span> + ip.isLoopbackAddress());</span><br><span class="line">		<span class="comment">//(10.0.0.0 ~ 10.255.255.255)(172.16.0.0 ~ 172.31.255.255)(192.168.0.0 ~ 192.168.255.255)</span></span><br><span class="line">		System.out.println(<span class="string">"是否是地区本地地址       :"</span> + ip.isSiteLocalAddress());</span><br><span class="line">		<span class="comment">// 允许服务器主机接受来自任何网络接口的客户端连接</span></span><br><span class="line">		System.out.println(<span class="string">"是否是通配符地址         :"</span> + ip.isAnyLocalAddress());</span><br><span class="line">		<span class="comment">// (169.254.0.0 ~ 169.254.255.255)</span></span><br><span class="line">		System.out.println(<span class="string">"是否是本地连接地址       :"</span> + ip.isLinkLocalAddress());</span><br><span class="line">		<span class="comment">// (224.0.0.0 ~ 239.255.255.255)广播地址可以向网络中的所有计算机发送信息</span></span><br><span class="line">		System.out.println(<span class="string">"是否是 广播地址           :"</span> + ip.isMulticastAddress());</span><br><span class="line">		<span class="comment">//  除了(224.0.0.0)和第一个字节是239的IP地址都是全球范围的广播地址</span></span><br><span class="line">		System.out.println(<span class="string">"是否是全球范围的广播地址:"</span> + ip.isMCGlobal());</span><br><span class="line">		<span class="comment">// (224.0.0.0 ~ 224.0.0.255)</span></span><br><span class="line">		System.out.println(<span class="string">"是否是子网广播地址         :"</span> + ip.isMCLinkLocal());</span><br><span class="line">		<span class="comment">// 本地接口广播地址不能将广播信息发送到产生广播信息的网络接口</span></span><br><span class="line">		<span class="comment">// 所有的IPv4广播地址都不是本地接口广播地址。</span></span><br><span class="line">		System.out.println(<span class="string">"是否是本地接口广播地址      :"</span> + ip.isMCNodeLocal());</span><br><span class="line">		<span class="comment">// 可以向公司或企业内部的所有的计算机发送广播信息</span></span><br><span class="line">		<span class="comment">// IPv4的组织范围广播地址的第一个字节是239，第二个字节不小于192，第三个字节不大于195</span></span><br><span class="line">		System.out.println(<span class="string">"是否是组织范围的广播地址:"</span> + ip.isMCOrgLocal());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">displayMac</span><span class="params">(<span class="keyword">byte</span>[] mac)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (mac == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		StringBuilder bufferBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mac.length; i++) &#123;</span><br><span class="line">			<span class="keyword">byte</span> b = mac[i];</span><br><span class="line">			<span class="keyword">int</span> intValue = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span> (b &gt;= <span class="number">0</span>)</span><br><span class="line">				intValue = b;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				intValue = <span class="number">256</span> + b;</span><br><span class="line">			bufferBuilder.append(Integer.toHexString(intValue));</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (i != mac.length - <span class="number">1</span>)</span><br><span class="line">				bufferBuilder.append(<span class="string">"-"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> bufferBuilder.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/JavaSE/">JavaSE</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/09/20/JavaSE/Java网络 网卡/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/09/20/JavaSE/Java网络 网卡/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/09/19/JavaSE/Java网络/" title="java网络基础" itemprop="url">java网络基础</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-09-18T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-09-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>Java里使用的是TCP/IP</p>
<ul>
<li>应用层协议：(例如Http协议) 该层数据由下三层协议共同制定</li>
<li>传输层协议：(常用TCP,UDP)(ICMP Ping命令基于该协议). 该层协议用于确保数据报以发送时的顺序接受,并且不会丢包. 如果发现顺序有误,或者数据丢失,则可要求对方重新发送数据(TCP会要求这一点, 但是UDP协议只是检查数据发送顺序,以及数据是否丢失并不要求对方重传数据)</li>
<li>网络层协议：(使用最广泛的是IP协议)<blockquote>
<p>网络层第一任务是对数据位或者字节进行分组,打成包(包内数据称为数据报).网络层第二任务定义了主机彼此间的寻址方式(例如IPV4用四个字节来标识一个地址).在JAVA里,IP协议是它唯一理解的网络层协议.</p>
</blockquote>
</li>
</ul>
<p>IP数据报格式<br>链路层协议：定义了网络接口(以太网接口或者环牌接口)</p>
<p>谈一下Internet地址分类 (具体定义参考 WIKI IP地址), IP地址分为A,B,C,D,E,F类 (E,F分别作为广播地址这里不说了)</p>
<ul>
<li>A类地址 第一个字节固定</li>
<li>B类地址 前俩个地址固定</li>
<li>C类地址 前三个地址固定<br>这里所说的固定指的是ISP给你的时候就固定了,你只能使用固定之后几位的地址.例如给了你一个C类地址 那么你只有256个地址可以使用.</li>
</ul>
<p>后来为了节约地址,出现了CIDR  用/nn 指定前几位为固定的.例如/24 为前24位即前三个字节是固定的也就是一个c类地址.这么着就拟补了有的组织使用的IP大于c类却远远小于B类而造成的地址浪费.</p>
<p>在这里需要特殊说明的是有一些非路由地址,例如10; 192.16或者172.16到172.31 开头的地址.这些地址用于构建组织内部网路(例如家里只有一个IP但是却有很多设备,这时就需要通过路由为这些设备分配IP地址了),或者一些大型组织使用C类地址时非常有用<br>路由器会将非路由地址转换为外部地址</p>
<p>URI<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scheme:scheme-specific-part (模式:模式特有部分)</span><br></pre></td></tr></table></figure></p>
<p>URI模式包含 data, file, ftp, http, news, telnet, urn (还有基于JAVA的rmi, jndi 等非标准模式,也称为protocol)<br>例如：<code>http://www.ming15.wang/2015/10/13/%E5%B7%A5%E5%85%B7/2015-10-12-AWK/</code>这个例子中模式为<code>http</code>, 负责解析该URI的机构<code>ming15.wang</code> 负责将<code>/2015/10/13/%E5%B7%A5%E5%85%B7/2015-10-12-AWK/</code>地址映射到主机资源</p>
<p>还有的URI路径中含有? 这是URI的查询部分.后面紧跟查询参数,多个参数用&amp;分割. 例如：<code>git@github.com:ming15/VertxServer.git</code>该URI中模式为<code>git</code> 解析结构为<code>github.com</code> 还可以在git和@之间加上用户名和密码<code>git://username:password@github.com:ming15/VertxServer.git</code></p>
<p>URI一般由以下组成</p>
<ul>
<li>模式</li>
<li>URI解析结构</li>
<li>资源路径</li>
<li>查询参数构成</li>
</ul>
<h3 id="URI分为类"><a href="#URI分为类" class="headerlink" title="URI分为类"></a>URI分为类</h3><ol>
<li>URL ： 指向Internet上某个位置的某个文件.用于标识Internet上的资源位置. 指定访问服务器的协议, 服务器名, 文件在次服务器上的位置<code>protocol://username@hostname:port/path/filename?query##fragment</code>协议可以看成是模式但是它不包含URN.</li>
<li>URN ：不指向位置的资源名.  (具体的内容参考例子磁力链接)<code>urn:namespace:resource_name</code>. <code>namespace</code>:某个授权机构维护的某类资源的集合名.  <code>resource_name</code> 集合中的资源名</li>
</ol>
<p>这里简述一下相对URL. 举例来说<code>&lt;a href=&quot;java.html&quot;&gt;</code> 这个超链接会继承父文档(当前文档)的协议, 主机名, 资源路径<code>.java.html</code>会替换掉,父文档里最后的文件名,还有例如<code>&lt;a href=&quot;/demo/java.html&quot;&gt;</code>那这个超链接会将主机名后的资源路径一起换掉 ，用该路径替换</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/JavaSE/">JavaSE</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/09/19/JavaSE/Java网络/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/09/19/JavaSE/Java网络/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/09/08/mgits/gitbook/" title="gitbook使用" itemprop="url">gitbook使用</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-09-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-09-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="安装gitbook命令行"><a href="#安装gitbook命令行" class="headerlink" title="安装gitbook命令行"></a>安装gitbook命令行</h1><ol>
<li>下载安装<code>npm</code>和<code>io.js</code></li>
<li>安装<code>git</code>, <code>gitbook</code>需要依赖<code>git</code>.</li>
<li>将<code>git</code>的<code>bin</code>目录放到环境变量<code>Path</code>里</li>
<li>在windows下npm module一般都是安装到<code>C:\Users\Administrator\AppData\Roaming\npm\node_modules</code>这<br> 里,所以为了我们能够使用安装好的module,我们将这个路径添加到环境变量<code>Path</code>里</li>
<li>然后使用<code>npm install gitbook-cli -g</code> 安装gitbook</li>
<li>最后验证一下gitbook是否安装成功： <code>gitbook -V</code> 我安装的是<code>0.3.3</code>, 所以在命令行里直接输出了<code>0.3.3</code></li>
</ol>
<h1 id="gitbook-github简历博客"><a href="#gitbook-github简历博客" class="headerlink" title="gitbook + github简历博客"></a>gitbook + github简历博客</h1><p>我们假设下列所有操作都在<code>D:\git</code>这个目录下操作</p>
<ol>
<li>我们将github上创建的项目<code>demo</code>检出到<code>D:\git</code>目录里,最好你也是用svn检出的，因为我是在svn检出的前提下写了个小工具</li>
<li>然后我们进入到<code>D:\git\demo</code>目录里,我们会看到<code>branches</code>和<code>trunk</code>俩个文件夹,<code>branches</code>用于存储博客的web文件,<code>trunk</code>用于存放博客的<code>markdown</code>源文件</li>
<li>接着我们进入到<code>D:\git\demo\trunk</code>新建<code>blog</code>文件夹</li>
<li>进入到<code>D:\git\demo\trunk\blog</code>在这个目录里新建一个<code>build.bat</code>批处理脚本文件,同时创建一个<code>repository</code></li>
<li><code>build.bat</code>批处理脚本文件内容为<code>gitbook build ./repository ../../branches/gh-pages</code></li>
<li>我们使用gitbook客户端在<code>repository</code>文件夹内创建一个gitbook项目</li>
<li>双击运行<code>build.bat</code></li>
<li>查看<code>D:\git\demo\branches\gh-pages</code>是否生成了一个web站点呢？这个就是我们的博客了</li>
<li>最后在<code>D:\git\demo</code>这个目录里上传所有的文件就好了</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/mgits/">mgits</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/09/08/mgits/gitbook/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/09/08/mgits/gitbook/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/groovy/groovyIO/" title="groovy IO" itemprop="url">groovy IO</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-04-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>本文是对Groovy部分官方文档进行了翻译</p>
</blockquote>
<h3 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h3><p>作为第一个例子,让我们看一下,如何输出一个文本文件里的所有行<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir, <span class="string">'haiku.txt'</span>).eachLine &#123; line -&gt;</span><br><span class="line">    println line</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>eachLine</code>方法是Groovy自动添加到File Class的,同时呢,Groovy还添加了很多变量,例如,你如果想要知道每一行的行号,你可以使用这个变量:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir, <span class="string">'haiku.txt'</span>).eachLine &#123; line, nb -&gt;</span><br><span class="line">    println <span class="string">"Line $nb: $line"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>无论由于什么原因, 当<code>eachLine</code>中抛出了异常,这个方法都会确保,资源已经被正确的关闭掉了. 这对所有Groovy自动添加的关于I/O资源的方法都有效.</p>
<p>例如, 某种情况你使用了<code>Reader</code>, 但是你还想让Groovy自己管理资源. 下面这个例子, 即使抛出了exception, reader仍然会被自动关闭.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> count = <span class="number">0</span>, MAXSIZE = <span class="number">3</span></span><br><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">"haiku.txt"</span>).withReader &#123; reader -&gt;</span><br><span class="line">    <span class="keyword">while</span> (reader.readLine()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (++count &gt; MAXSIZE) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">'Haiku should only have 3 verses'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如果你想要把文本文件中每一行都放进一个list中, 你可以这么做:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = <span class="keyword">new</span> File(baseDir, <span class="string">'haiku.txt'</span>).collect &#123;it&#125;</span><br></pre></td></tr></table></figure></p>
<p>或者你想利用操作符将文件中每一行都添加到一个数组中:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> array = <span class="keyword">new</span> File(baseDir, <span class="string">'haiku.txt'</span>) <span class="keyword">as</span> String[]</span><br></pre></td></tr></table></figure></p>
<p>下面这个示例,非常简单的实现了,将一个文件存进一个字节数组里:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">byte</span>[] contents = file.bytes</span><br></pre></td></tr></table></figure></p>
<p>如下例,我们轻松地获得了一个输入流.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> is = <span class="keyword">new</span> File(baseDir,<span class="string">'haiku.txt'</span>).newInputStream()</span><br><span class="line"><span class="comment">// do something ...</span></span><br><span class="line">is.close()</span><br></pre></td></tr></table></figure></p>
<p>上个例子中我们获得了一个输入流,但是最后我们不得不手动关闭它, Groovy提供另一个方法<code>withInputStream</code>, 这个方法可以帮我们自动的关闭输入流.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">'haiku.txt'</span>).withInputStream &#123; stream -&gt;</span><br><span class="line">    <span class="comment">// do something ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="写文件"><a href="#写文件" class="headerlink" title="写文件"></a>写文件</h3><p>有时候,你需要的也许只是写文件,下面展示了,如何在Groovy中写文件<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">'haiku.txt'</span>).withWriter(<span class="string">'utf-8'</span>) &#123; writer -&gt;</span><br><span class="line">    writer.writeLine <span class="string">'Into the ancient pond'</span></span><br><span class="line">    writer.writeLine <span class="string">'A frog jumps'</span></span><br><span class="line">    writer.writeLine <span class="string">'Water’s sound!'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>但对于一个要求很简单的需求来说,我们可以使用<code>&lt;&lt;</code>向文件中写<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">'haiku.txt'</span>) &lt;&lt; <span class="string">'''Into the ancient pond</span><br><span class="line">A frog jumps</span><br><span class="line">Water’s sound!'''</span></span><br></pre></td></tr></table></figure></p>
<p>当然不是每一次我们都是向文件中输出文本,下面的例子演示了,我们如何向一个文件中写入字节:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file.bytes = [<span class="number">66</span>,<span class="number">22</span>,<span class="number">11</span>]</span><br></pre></td></tr></table></figure></p>
<p>当然,你也可以直接打开一个输出流,下面的例子演示了如何开启一个输出流.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> os = <span class="keyword">new</span> File(baseDir,<span class="string">'data.bin'</span>).newOutputStream()</span><br><span class="line"><span class="comment">// do something ...</span></span><br><span class="line">os.close()</span><br></pre></td></tr></table></figure></p>
<p>同<code>newInputStream</code>一样,<code>newOutputStream</code>同样需要手动关闭, ok,你大概想到了<code>withOutputStream</code>:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> File(baseDir,<span class="string">'data.bin'</span>).withOutputStream &#123; stream -&gt;</span><br><span class="line">    <span class="comment">// do something ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="遍历文件"><a href="#遍历文件" class="headerlink" title="遍历文件"></a>遍历文件</h3><p>在脚本中, 有个很常用的需求就是,遍历一个目录,然后找到一个文件,进行某些操作. Groovy提供了很多方法,来达到这个效果. 下面的例子演示了将一个目录下的所有文件都执行某个操作:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dir.eachFile &#123; file -&gt;                      (<span class="number">1</span>)</span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br><span class="line">dir.eachFileMatch(<span class="regexp">~/.*\.txt/</span>) &#123; file -&gt;     (<span class="number">2</span>)</span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>在目录下的每个文件上执行闭包操作.</li>
<li>根据正则表达式在目录下找到符合条件的文件,然后执行闭包操作.</li>
</ol>
<p>也许你想要遍历某个目录和目录里的所有子目录, 那么你可以使用<code>eachFileRecurse</code><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">dir.eachFileRecurse &#123; file -&gt;                      (<span class="number">1</span>)</span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dir.eachFileRecurse(FileType.FILES) &#123; file -&gt;      (<span class="number">2</span>)</span><br><span class="line">    println file.name</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>对目录里的所有子目录进行递归, 然后对找到的文件和目录进行闭包操作</li>
<li>对目录里进行递归查找,但是只查找文件.</li>
</ol>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dir.traverse &#123; file -&gt;</span><br><span class="line">    <span class="keyword">if</span> (file.directory &amp;&amp; file.name==<span class="string">'bin'</span>) &#123;</span><br><span class="line">        FileVisitResult.TERMINATE                   (<span class="number">1</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        println file.name</span><br><span class="line">        FileVisitResult.CONTINUE                    (<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>如果找到的文件是目录,且它的名字是”dir”, 则停止遍历</li>
<li>打印出文件的名字,接着遍历</li>
</ol>
<h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><p>在java中会使用<code>java.io.DataOutputStream</code> 序列化数据也不罕见. Groovy对这个需求也做了非常简单的实现, 下面的例子演示了如何序列化和反序列化:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">boolean</span> b = <span class="literal">true</span></span><br><span class="line">String message = <span class="string">'Hello from Groovy'</span></span><br><span class="line"><span class="comment">// Serialize data into a file</span></span><br><span class="line">file.withDataOutputStream &#123; out -&gt;</span><br><span class="line">    out.writeBoolean(b)</span><br><span class="line">    out.writeUTF(message)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// Then read it back</span></span><br><span class="line">file.withDataInputStream &#123; input -&gt;</span><br><span class="line">    <span class="keyword">assert</span> input.readBoolean() == b</span><br><span class="line">    <span class="keyword">assert</span> input.readUTF() == message</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>同样,如果这个数据实例了序列化接口<code>Serializable</code>, 你可以使用 object output stream将整个数据序列化到文件:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Person p = <span class="keyword">new</span> Person(<span class="string">name:</span><span class="string">'Bob'</span>, <span class="string">age:</span><span class="number">76</span>)</span><br><span class="line"><span class="comment">// Serialize data into a file</span></span><br><span class="line">file.withObjectOutputStream &#123; out -&gt;</span><br><span class="line">    out.writeObject(p)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// Then read it back</span></span><br><span class="line">file.withObjectInputStream &#123; input -&gt;</span><br><span class="line">    <span class="keyword">def</span> p2 = input.readObject()</span><br><span class="line">    <span class="keyword">assert</span> p2.name == p.name</span><br><span class="line">    <span class="keyword">assert</span> p2.age == p.age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="执行命令"><a href="#执行命令" class="headerlink" title="执行命令"></a>执行命令</h3><p>前面的章节介绍了在Groovy中操作files, readers or streams非常简单. 然而, 像系统管理员或者开发者,可能更多的是执行一个系统命令.</p>
<p>Groovy同样提供了非常简单的方式执行命令行命令. 只需要定义一个命令的字符串,然后执行这个字符串的<code>execute()</code>. 在类Unix系统中(如果在windows中也安装了类Unix命令行工具也算),你可以这样执行命令.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">"ls -l"</span>.execute()             (<span class="number">1</span>)</span><br><span class="line">println <span class="string">"Found text $&#123;process.text&#125;"</span>        (<span class="number">2</span>)</span><br></pre></td></tr></table></figure></p>
<ol>
<li>在外部过程(external process)执行ls命令</li>
<li>获得命令的输出,并输出</li>
</ol>
<p><code>execute()</code>方法返回一个<code>java.lang.Process</code>实例, 随后选择一种输出流<code>in/out/err</code>, 同时检查<code>exit</code>值,查看是否命令执行完毕.</p>
<p>下面的例子使用了和刚才那个例子一样的命令,但是现在我们每次都会对获得的结果进行行输出.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">            <span class="keyword">def</span> process = <span class="string">"ls -l"</span>.execute()             (<span class="number">1</span>)</span><br><span class="line">            process.<span class="keyword">in</span>.eachLine &#123; line -&gt;               (<span class="number">2</span>)</span><br><span class="line">                println line                            (<span class="number">3</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">assert</span> process <span class="keyword">instanceof</span> Process</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> testProcessConsumeOutput() &#123;</span><br><span class="line">        <span class="keyword">if</span> (unixlike) &#123;</span><br><span class="line">            doInTmpDir &#123; b -&gt;</span><br><span class="line">                File file = <span class="literal">null</span></span><br><span class="line">                <span class="keyword">def</span> tmpDir = b.tmp &#123;</span><br><span class="line">                    file = <span class="string">'foo.tmp'</span>(<span class="string">'foo'</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">assert</span> file.exists()</span><br><span class="line">                <span class="keyword">def</span> p = <span class="string">"rm -f foo.tmp"</span>.execute([], tmpDir)</span><br><span class="line">                p.consumeProcessOutput()</span><br><span class="line">                p.waitFor()</span><br><span class="line">                <span class="keyword">assert</span> !file.exists()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> testProcessPipe() &#123;</span><br><span class="line">        <span class="keyword">if</span> (unixlike) &#123;</span><br><span class="line">            doInTmpDir &#123; b -&gt;</span><br><span class="line">                <span class="keyword">def</span> proc1, proc2, proc3, proc4</span><br><span class="line">                proc1 = <span class="string">'ls'</span>.execute()</span><br><span class="line">                proc2 = <span class="string">'tr -d o'</span>.execute()</span><br><span class="line">                proc3 = <span class="string">'tr -d e'</span>.execute()</span><br><span class="line">                proc4 = <span class="string">'tr -d i'</span>.execute()</span><br><span class="line">                proc1 | proc2 | proc3 | proc4</span><br><span class="line">                proc4.waitFor()</span><br><span class="line">                <span class="keyword">if</span> (proc4.exitValue()) &#123;</span><br><span class="line">                    println proc4.err.text</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    println proc4.text</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">def</span> sout = <span class="keyword">new</span> StringBuilder()</span><br><span class="line">                <span class="keyword">def</span> serr = <span class="keyword">new</span> StringBuilder()</span><br><span class="line">                proc2 = <span class="string">'tr -d o'</span>.execute()</span><br><span class="line">                proc3 = <span class="string">'tr -d e'</span>.execute()</span><br><span class="line">                proc4 = <span class="string">'tr -d i'</span>.execute()</span><br><span class="line">                proc4.consumeProcessOutput(sout, serr)</span><br><span class="line">                proc2 | proc3 | proc4</span><br><span class="line">                [proc2, proc3].each &#123; it.consumeProcessErrorStream(serr) &#125;</span><br><span class="line">                proc2.withWriter &#123; writer -&gt;</span><br><span class="line">                    writer &lt;&lt; <span class="string">'testfile.groovy'</span></span><br><span class="line">                &#125;</span><br><span class="line">                proc4.waitForOrKill(<span class="number">1000</span>)</span><br><span class="line">                println <span class="string">"Standard output: $sout"</span></span><br><span class="line">                println <span class="string">"Standard error: $serr"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> &#123;</span></span><br><span class="line">        String name</span><br><span class="line">        <span class="keyword">int</span> age</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>1    executes the ls command in an external process<br>2    for each line of the input stream of the process<br>3    print the line</p>
<ol>
<li>在外部进程中执行ls命令<br>2.</li>
</ol>
<p>It is worth noting that in corresponds to an input stream to the standard output of the command. out will refer to a stream where you can send data to the process (its standard input).</p>
<p>Remember that many commands are shell built-ins and need special handling. So if you want a listing of files in a directory on a Windows machine and write:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">"dir"</span>.execute()</span><br><span class="line">println <span class="string">"$&#123;process.text&#125;"</span></span><br></pre></td></tr></table></figure>
<p>接着你会收到一个异常<code>IOException</code>,异常信息为<code>Cannot run program &quot;dir&quot;: CreateProcess error=2</code>,系统找不到指定的文件.</p>
<p>这是因为<code>dir</code>是内建于<code>windows shell(cmd.ext)</code>, 想要使用那个命令,你要像下面这个样操作:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> process = <span class="string">"cmd /c dir"</span>.execute()</span><br><span class="line">println <span class="string">"$&#123;process.text&#125;"</span></span><br></pre></td></tr></table></figure></p>
<p>还有,因为上述的功能是在内部使用的<code>java.lang.Process</code>, 这个类的一些不足的地方,我们也要充分考虑. 在javadoc中,是这样描述这个类的:</p>
<blockquote>
<p>Because some native platforms only provide limited buffer size for standard input and output streams, failure to promptly write the input stream or read the output stream of the subprocess may cause the subprocess to block, and even deadlock<br>Because of this, Groovy provides some additional helper methods which make stream handling for processes easier.</p>
</blockquote>
<p>现在演示一下,如何输出进程里所有的输出(包括error stream).<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> p = <span class="string">"rm -f foo.tmp"</span>.execute([], tmpDir)</span><br><span class="line">p.consumeProcessOutput()</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure></p>
<p><code>consumeProcessOutput</code>仍然有很多对<code>StringBuffer</code>, <code>InputStream</code>, <code>OutputStream</code>等封装的变量, 如果想要获取一个完整的封装列表的,那可以参考 <a href="http://docs.groovy-lang.org/latest/html/groovy-jdk/java/lang/Process.html" target="_blank" rel="external">GDK API for java.lang.Process</a></p>
<p>另外, <code>pipeTo</code>命令 可以让一个进程的输出流连接到一个进程的输入流里. 如下例:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">proc1 = <span class="string">'ls'</span>.execute()</span><br><span class="line">proc2 = <span class="string">'tr -d o'</span>.execute()</span><br><span class="line">proc3 = <span class="string">'tr -d e'</span>.execute()</span><br><span class="line">proc4 = <span class="string">'tr -d i'</span>.execute()</span><br><span class="line">proc1 | proc2 | proc3 | proc4</span><br><span class="line">proc4.waitFor()</span><br><span class="line"><span class="keyword">if</span> (proc4.exitValue()) &#123;</span><br><span class="line">    println proc4.err.text</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    println proc4.text</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Consuming errors<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> sout = <span class="keyword">new</span> StringBuilder()</span><br><span class="line"><span class="keyword">def</span> serr = <span class="keyword">new</span> StringBuilder()</span><br><span class="line">proc2 = <span class="string">'tr -d o'</span>.execute()</span><br><span class="line">proc3 = <span class="string">'tr -d e'</span>.execute()</span><br><span class="line">proc4 = <span class="string">'tr -d i'</span>.execute()</span><br><span class="line">proc4.consumeProcessOutput(sout, serr)</span><br><span class="line">proc2 | proc3 | proc4</span><br><span class="line">[proc2, proc3].each &#123; it.consumeProcessErrorStream(serr) &#125;</span><br><span class="line">proc2.withWriter &#123; writer -&gt;</span><br><span class="line">    writer &lt;&lt; <span class="string">'testfile.groovy'</span></span><br><span class="line">&#125;</span><br><span class="line">proc4.waitForOrKill(<span class="number">1000</span>)</span><br><span class="line">println <span class="string">"Standard output: $sout"</span></span><br><span class="line">println <span class="string">"Standard error: $serr"</span></span><br></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Groovy/">Groovy</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/04/08/groovy/groovyIO/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/08/groovy/groovyIO/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/groovy/groovy/" title="groovy注释和标识符" itemprop="url">groovy注释和标识符</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-04-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>本文是对Groovy部分官方文档进行了翻译</p>
</blockquote>
<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><h3 id="单行注释"><a href="#单行注释" class="headerlink" title="单行注释"></a>单行注释</h3><p>想要使用单行注释, 使用<code>//</code>就可以了.  本行中<code>//</code>后续的内容都会被认为是注释的一部分<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a standalone single line comment</span></span><br><span class="line">println <span class="string">"hello"</span> <span class="comment">// a comment till the end of the line</span></span><br></pre></td></tr></table></figure></p>
<h3 id="多行注释"><a href="#多行注释" class="headerlink" title="多行注释"></a>多行注释</h3><p>多行注释从<code>/*</code>开始, 直到<code>*/</code>结束(跨行也包含在内)<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* a standalone multiline comment</span><br><span class="line">spanning two lines */</span></span><br><span class="line">println <span class="string">"hello"</span> <span class="comment">/* a multiline comment starting</span><br><span class="line">at the end of a statement */</span></span><br><span class="line">println <span class="number">1</span> <span class="comment">/* one */</span> + <span class="number">2</span> <span class="comment">/* two */</span></span><br></pre></td></tr></table></figure></p>
<h4 id="GroovyDoc-注释"><a href="#GroovyDoc-注释" class="headerlink" title="GroovyDoc 注释"></a>GroovyDoc 注释</h4><p><code>GroovyDoc</code> 注释也是多行的, 但是它是以<code>/**</code>开始, <code>*/</code>结束定义的.<br>这种注释一般用于以下情况：</p>
<ul>
<li>类型定义(包含 classes, interfaces, enums, annotations)</li>
<li>字段和属性定义</li>
<li>方法定义</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span><br><span class="line">  * A Class description</span><br><span class="line">  */</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">     <span class="comment">/** the name of the person */</span></span><br><span class="line">     String name</span><br><span class="line"></span><br><span class="line">     <span class="comment">/**</span><br><span class="line">      * Creates a greeting method for a certain person.</span><br><span class="line">      *</span><br><span class="line">      * <span class="doctag">@param</span> otherPerson the person to greet</span><br><span class="line">      * <span class="doctag">@return</span> ag reeting message</span><br><span class="line">      */</span></span><br><span class="line">     String greet(String otherPerson) &#123;</span><br><span class="line">        <span class="string">"Hello $&#123;otherPerson&#125;"</span></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Shebang-line"><a href="#Shebang-line" class="headerlink" title="Shebang line"></a>Shebang line</h3><p>除了上面提到的单行注释外, 还有一种特殊的单行注释.这种注释在UNIX系统下通常称为shebang线, 这种注释允许脚本直接在命令行里执行( 但是前提是你已经在系统是安装了<code>groovy</code>,并且在<code>PATH</code>里进行了配置)</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env groovy</span></span><br><span class="line">println <span class="string">"Hello from the shebang line"</span></span><br></pre></td></tr></table></figure>
<p><code>#</code>字符必须是这个文件里的第一个字符,否则编译器将会抛出一个编译错误.</p>
<h2 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h2><h3 id="普通标识符"><a href="#普通标识符" class="headerlink" title="普通标识符"></a>普通标识符</h3><p>标识符以一个<code>字母</code>或者<code>$</code>或者<code>_</code>开始, 不能以数字打头.<br>如果以字母打头,他们在下列范围内</p>
<ul>
<li>‘a’ to ‘z’ (lowercase ascii letter)</li>
<li>‘A’ to ‘Z’ (uppercase ascii letter)</li>
<li>‘\u00C0’ to ‘\u00D6’</li>
<li>‘\u00D8’ to ‘\u00F6’</li>
<li>‘\u00F8’ to ‘\u00FF’</li>
<li>‘\u0100’ to ‘\uFFFE’</li>
</ul>
<p>剩下的字符就可以包含字母或者数字了.  下面列举了一些合法的标识符：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> name</span><br><span class="line"><span class="keyword">def</span> item3</span><br><span class="line"><span class="keyword">def</span> with_underscore</span><br><span class="line"><span class="keyword">def</span> $dollarStart</span><br></pre></td></tr></table></figure></p>
<p>下面是一些非法的标识符<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def 3tier</span><br><span class="line">def a+b</span><br><span class="line">def a#b</span><br></pre></td></tr></table></figure></p>
<p><code>.</code>后面的关键字也是合法的标识符<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foo.<span class="keyword">as</span></span><br><span class="line">foo.<span class="keyword">assert</span></span><br><span class="line">foo.<span class="keyword">break</span></span><br><span class="line">foo.<span class="keyword">case</span></span><br><span class="line">foo.<span class="keyword">catch</span></span><br></pre></td></tr></table></figure></p>
<h3 id="带引号的标识符"><a href="#带引号的标识符" class="headerlink" title="带引号的标识符"></a>带引号的标识符</h3><p>带引号的标识符出现在<code>.\</code>. 例如<code>person.name</code>表达式中的<code>name</code>部分能通过这俩种方式引起来<code>person.&quot;name&quot;</code>或者<code>person.\&#39;name&#39;</code>. 当特定标识符中包含非法字符(java语言禁止的字符),但是通过引号的方式可以达到在Groovy的合法. 例如,一个破折号,一个空格,一个感叹号,<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [:]</span><br><span class="line"></span><br><span class="line">map.<span class="string">"an identifier with a space and double quotes"</span> = <span class="string">"ALLOWED"</span></span><br><span class="line">map.<span class="string">'with-dash-signs-and-single-quotes'</span> = <span class="string">"ALLOWED"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> map.<span class="string">"an identifier with a space and double quotes"</span> == <span class="string">"ALLOWED"</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="string">'with-dash-signs-and-single-quotes'</span> == <span class="string">"ALLOWED"</span></span><br></pre></td></tr></table></figure></p>
<p>正像一会我们在strings模块看到的一样, Groovy提供了不同的string字面量. 以下所列举的都是合法的<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">map.<span class="string">'single quote'</span></span><br><span class="line">map.<span class="string">"double quote"</span></span><br><span class="line">map.<span class="string">'''triple single quote'''</span></span><br><span class="line">map.<span class="string">"""triple double quote"""</span></span><br><span class="line">map.<span class="regexp">/slashy string/</span></span><br><span class="line">map.<span class="string">$/dollar slashy string/$</span></span><br></pre></td></tr></table></figure></p>
<p>strings 和 Groovy’s GStrings 在纯字符上面是有一点不同的,as in that the latter case, the interpolated values are inserted in the final string for evaluating the whole identifier:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> firstname = <span class="string">"Homer"</span></span><br><span class="line">map.<span class="string">"Simson-$&#123;firstname&#125;"</span> = <span class="string">"Homer Simson"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> map.<span class="string">'Simson-Homer'</span> == <span class="string">"Homer Simson"</span></span><br></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Groovy/">Groovy</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/04/08/groovy/groovy/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/08/groovy/groovy/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/groovy/groovy json/" title="groovy JSON" itemprop="url">groovy JSON</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-04-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>本文是对Groovy部分官方文档进行了翻译</p>
</blockquote>
<p>Groovy 原生支持Groovy对象和JSON之间的转换. <code>groovy.json</code>包内的类用于JSON的序列化和解析功能</p>
<h2 id="JsonSlurper"><a href="#JsonSlurper" class="headerlink" title="JsonSlurper"></a>JsonSlurper</h2><p><code>JsonSlurper</code>用于将JSON文本或者其他数据内容解析成Groovy里的数据结构,例如<code>maps&lt;/code&gt;,</code>lists, 或者其他原生基本类型 <code>Integer&lt;/code&gt;,</code>Double, <code>Boolean&lt;/code&gt;,</code>String`。</p>
<p>这个类重载了很多方法, 而且还添加了一些特殊的方法, 例如<code>parseText&lt;/code&gt;,</code>parseFile<code>等.下面这个例子中我们使用了</code>parseText<code>方法, 它会解析一个JSON字符串, 然后递归地将它转换成</code>list, <code>map</code>结构. 一些其他的`parse* 方法和这个方法很类似, 都返回了JSON字符串, 只不过其他的方法接受的参数不一样.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> jsonSlurper = <span class="keyword">new</span> JsonSlurper()</span><br><span class="line"><span class="keyword">def</span> object = jsonSlurper.parseText(<span class="string">'&#123; "name": "John Doe" &#125; /* some comment */'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> object <span class="keyword">instanceof</span> Map</span><br><span class="line"><span class="keyword">assert</span> object.name == <span class="string">'John Doe'</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是, 产生的结果是一个纯map, 可以像一个普通的Groovy对象实例持有它. <code>JsonSlurper</code>根据<a href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf" target="_blank" rel="external">ECMA-404 JSON Interchange Standard</a>定义来解析JSON, 同时支持JavaScript的注释和时间类型.</p>
<p>除了支持maps之外, <code>JsonSlurper</code> 还支持将JSON数组解析成list的功能<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> jsonSlurper = <span class="keyword">new</span> JsonSlurper()</span><br><span class="line"><span class="keyword">def</span> object = jsonSlurper.parseText(<span class="string">'&#123; "myList": [4, 8, 15, 16, 23, 42] &#125;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> object <span class="keyword">instanceof</span> Map</span><br><span class="line"><span class="keyword">assert</span> object.myList <span class="keyword">instanceof</span> List</span><br><span class="line"><span class="keyword">assert</span> object.myList == [<span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>]</span><br></pre></td></tr></table></figure></p>
<p>JSON标准上只支持下面这些原生数据类型：<code>string&lt;/code&gt;,</code>number, <code>object&lt;/code&gt;,</code>true, <code>false&lt;/code&gt;,</code>null. <code>JsonSlurper</code> 将那些JSON类型转换成Groovy类型.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> jsonSlurper = <span class="keyword">new</span> JsonSlurper()</span><br><span class="line"><span class="keyword">def</span> object = jsonSlurper.parseText <span class="string">'''</span><br><span class="line">    &#123; "simple": 123,</span><br><span class="line">      "fraction": 123.66,</span><br><span class="line">      "exponential": 123e12</span><br><span class="line">    &#125;'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> object <span class="keyword">instanceof</span> Map</span><br><span class="line"><span class="keyword">assert</span> object.simple.<span class="keyword">class</span> == Integer</span><br><span class="line"><span class="keyword">assert</span> object.fraction.<span class="keyword">class</span> == BigDecimal</span><br><span class="line"><span class="keyword">assert</span> object.exponential.<span class="keyword">class</span> == BigDecimal</span><br></pre></td></tr></table></figure></p>
<p><code>JsonSlurper</code> 生成的结果就是纯Groovy对象实例, 她的内部不会包含任何的JSON相关的类对象, 它的用法是相当透明的. 事实上<code>JsonSlurper</code>的结果遵循<code>GPath</code>表达式. <code>GPath</code>是一个非常强大的表达式语言, 它支持多种不同的数据格式(例如<code>XmlSlurper</code>支持<code>XML</code> 就是其中一个例子)</p>
<p>如果想要了解更多的内容, 你可以直接去<a href="http://docs.groovy-lang.org/latest/html/documentation/core-semantics.html#gpath_expressions" target="_blank" rel="external">GPath expressions</a>看一看.<br>下面给出了JSON类型与Groovy数据类型之间的对应关系.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">JSON			Groovy</span><br><span class="line">string			java.lang.String</span><br><span class="line">number			java.lang.BigDecimal or java.lang.Integer</span><br><span class="line">object			java.util.LinkedHashMap</span><br><span class="line">array			java.util.ArrayList</span><br><span class="line"><span class="literal">true</span>			<span class="literal">true</span></span><br><span class="line"><span class="literal">false</span>			<span class="literal">false</span></span><br><span class="line"><span class="literal">null</span>			<span class="literal">null</span></span><br><span class="line">date			java.util.Date based on the yyyy-MM-dd’T’<span class="string">HH:</span><span class="string">mm:</span>ssZ date format</span><br></pre></td></tr></table></figure></p>
<p>如果JSON中的一个值是<code>null&lt;/code&gt;,</code>JsonSlurper<code>支持它转换成Groovy中的</code>null.这就与其他JSON解析器形成了对比, 代表一个空值与库提供的单一对象。</p>
<h3 id="Parser-Variants"><a href="#Parser-Variants" class="headerlink" title="Parser Variants"></a>Parser Variants</h3><p>Groovy 有多个<code>JsonSlurper</code> 解析器实现. 每一个解析器都对应着不同的需求, 每一个特定的解析都能很好的处理特定需求, 所以默认的解析器并不是适应于所有的情况. 下面就对各个解析器做个简介:</p>
<p><code>JsonParserCharArray</code> 解析器接受一个JSON字符串, 然后其内部使用一个字节数组进行解析. During value conversion it copies character sub-arrays (a mechanism known as “chopping”) and operates on them.</p>
<ul>
<li><p><code>JsonFastParser</code>解析器是<code>JsonParserCharArray</code>解析器的变种, 它是最快的解析器. 尽管它是最快的,但是基于某些原因,它并不是默认的解析器. <code>JsonFastParser</code>解析器也被称为索引覆盖(index-overlay)解析器. 当解析给定JSON字符串的时候,该解析器会极力避免创建新的字节数组或者字符串实例. 它一直指向原生的字节数组。 另外, 它会尽可能的推迟对象的创建. If parsed maps are put into long-term caches care must be taken as the map objects might not be created and still consist of pointer to the original char buffer only. <code>JsonFastParser</code>采取了一种特殊的切割模型, 它会尽早地分割char buffer, 以便能维持一份对原生buffer比较小的拷贝. 如果你想使用<code>JsonFastParser&lt;/code&gt;, 那么给你的建议是保持</code>JsonFastParser`的JSON buffer在2MB左右, 而且时刻要保持长期缓存限制.</p>
</li>
<li><p><code>JsonParserLax</code> 是<code>JsonFastParser</code>的一个变种实现. 它与<code>JsonFastParser</code> 有一些相似的想能特点, 但是不同的是它不是仅仅依靠`ECMA-404 JSON grammar. 例如,在下面例子中它支持不带引号的字符串注释.</p>
</li>
</ul>
<p><code>JsonParserUsingCharacterSource</code> 用于解析非常大的文件. 它使用一种称为<code>“character windowing”</code>的技术去解析非常大(超过2MB)的JSON文件,而且性能上也非常稳定</p>
<p><code>JsonSlurper</code>的默认实现是 <code>JsonParserCharArray&lt;/code&gt;.</code>JsonParserType`包含了解析器种类的枚举类型:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Implementation					Constant</span><br><span class="line">JsonParserCharArray				JsonParserType#CHAR_BUFFER</span><br><span class="line">JsonFastParser					JsonParserType#INDEX_OVERLAY</span><br><span class="line">JsonParserLax					JsonParserType#LAX</span><br><span class="line">JsonParserUsingCharacterSource	JsonParserType#CHARACTER_SOURCE</span><br></pre></td></tr></table></figure>
<p>如果想要改变解析器的实现也非常简单, 只需要通过调用<code>JsonSlurper#setType()&lt;/code&gt;方法给</code>JsonParserType`设置上不同的值就可以了</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> jsonSlurper = <span class="keyword">new</span> JsonSlurper(<span class="string">type:</span> JsonParserType.INDEX_OVERLAY)</span><br><span class="line"><span class="keyword">def</span> object = jsonSlurper.parseText(<span class="string">'&#123; "myList": [4, 8, 15, 16, 23, 42] &#125;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> object <span class="keyword">instanceof</span> Map</span><br><span class="line"><span class="keyword">assert</span> object.myList <span class="keyword">instanceof</span> List</span><br><span class="line"><span class="keyword">assert</span> object.myList == [<span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>]</span><br></pre></td></tr></table></figure>
<h3 id="JsonOutput"><a href="#JsonOutput" class="headerlink" title="JsonOutput"></a>JsonOutput</h3><p><code>JsonOutput</code>用于将Groovy对象序列化成JSON字符串.</p>
<p><code>JsonOutput</code> 重载了<code>toJson</code>静态方法. 每个不同的<code>toJson</code>方法都会接受一个不同的参数类型.</p>
<p><code>toJson</code>方法返回的是一个包含JSOn格式的字符串<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> json = JsonOutput.toJson([<span class="string">name:</span> <span class="string">'John Doe'</span>, <span class="string">age:</span> <span class="number">42</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> json == <span class="string">'&#123;"name":"John Doe","age":42&#125;'</span></span><br></pre></td></tr></table></figure></p>
<p><code>JsonOutput</code>不仅支持原生类型, map, list等类型序列化到JSON, 甚至还支持序列化`POGOs(一种比较老的Groovy对象)</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span> String name &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> json = JsonOutput.toJson([ <span class="keyword">new</span> Person(<span class="string">name:</span> <span class="string">'John'</span>), <span class="keyword">new</span> Person(<span class="string">name:</span> <span class="string">'Max'</span>) ])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> json == <span class="string">'[&#123;"name":"John"&#125;,&#123;"name":"Max"&#125;]'</span></span><br></pre></td></tr></table></figure>
<p>刚才那个例子中, JSON输出默认没有进行pretty输出. 因此<code>JsonSlurper</code>还提供了<code>prettyPrint</code>方法<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> json = JsonOutput.toJson([<span class="string">name:</span> <span class="string">'John Doe'</span>, <span class="string">age:</span> <span class="number">42</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> json == <span class="string">'&#123;"name":"John Doe","age":42&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> JsonOutput.prettyPrint(json) == <span class="string">'''\</span><br><span class="line">&#123;</span><br><span class="line">    "name": "John Doe",</span><br><span class="line">    "age": 42</span><br><span class="line">&#125;'''</span>.stripIndent()</span><br></pre></td></tr></table></figure></p>
<p><code>prettyPrint</code>方法只接受一个String类型的字符串, 它不能和<code>JsonOutput</code>里其他的方式结合起来使用, it can be applied on arbitrary JSON String instances.</p>
<p>在Groovy中还可以使用<code>JsonBuilder&lt;/code&gt;,</code>StreamingJsonBuilder<code>方式创建JSON. 这俩个构建起都提供了一个</code>DSL, 当构建器生成一个JSON的时候,可以制定一个对象图.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// an inclusive range</span></span><br><span class="line"><span class="keyword">def</span> range = <span class="string">'a'</span>..<span class="string">'d'</span></span><br><span class="line"><span class="keyword">assert</span> range.size() == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> range.get(<span class="number">2</span>) == <span class="string">'c'</span></span><br><span class="line"><span class="keyword">assert</span> range[<span class="number">2</span>] == <span class="string">'c'</span></span><br><span class="line"><span class="keyword">assert</span> range <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="string">'a'</span>)</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="string">'d'</span>)</span><br><span class="line"><span class="keyword">assert</span> !range.contains(<span class="string">'e'</span>)</span><br></pre></td></tr></table></figure>
<p>You can iterate on a range using a classic for loop:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">1.</span><span class="number">.10</span>) &#123;</span><br><span class="line">    println <span class="string">"Hello $&#123;i&#125;"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>but alternatively you can achieve the same effect in a more Groovy idiomatic style, by iterating a range with each method:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1.</span><span class="number">.10</span>).each &#123; i -&gt;</span><br><span class="line">    println <span class="string">"Hello $&#123;i&#125;"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Ranges can be also used in the switch statement:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (years) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1.</span><span class="number">.10</span>: interestRate = <span class="number">0.076</span>; <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">11.</span><span class="number">.25</span>: interestRate = <span class="number">0.052</span>; <span class="keyword">break</span>;</span><br><span class="line"><span class="symbol">    default:</span> interestRate = <span class="number">0.037</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Groovy/">Groovy</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/04/08/groovy/groovy json/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/08/groovy/groovy json/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/groovy/groovy ant/" title="groovy ANT" itemprop="url">groovy ANT</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-04-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>本文是对Groovy部分官方文档进行了翻译</p>
</blockquote>
<p>虽然<code>Ant</code>只是一个构建工具, 但其提供了例如能够操作文件(包括zip文件), 拷贝, 资源管理等诸多实用功能. 然而如果你不喜欢使用<code>build.xml</code>文件或者<code>Jelly</code>脚本, 而是想要一种清晰简洁的构建方式, 那么你就可以试试使用Groovy编写构建过程.</p>
<p>Groovy提供了一个辅助类<code>AntBuilder</code>帮忙编写Ant构建任务. 它看起来很像一个不带尖括号的Ant’s XML的简洁版本. 因此你可以在脚本中混合和匹配标记. Ant本身是一组Jar文件的集合. 将这组jar文件添加到你的classpath上, 你就可以在Groovy中轻轻松松的使用它们.</p>
<p><code>AntBuilder</code>通过便捷的构造器语法直接暴露了Ant task. 下面是一个简单的示例, 它的功能是在标准输出上输出一条消息.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> ant = <span class="keyword">new</span> AntBuilder()          </span><br><span class="line">ant.echo(<span class="string">'hello from Ant!'</span>)</span><br></pre></td></tr></table></figure></p>
<ol>
<li>创建一个<code>AntBuilder</code>实例</li>
<li>执行<code>AntBuilder</code>实例的echo task</li>
</ol>
<p>假设,现在你需要创建一个ZIP文件：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> ant = <span class="keyword">new</span> AntBuilder()</span><br><span class="line">ant.zip(<span class="string">destfile:</span> <span class="string">'sources.zip'</span>, <span class="string">basedir:</span> <span class="string">'src'</span>)</span><br></pre></td></tr></table></figure></p>
<p>在下面的例子中, 我们将展示在Groovy中使用传统的Ant 模式通过<code>AntBuilder</code>拷贝一组文件.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lets just call one task</span></span><br><span class="line">ant.echo(<span class="string">"hello"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// here is an example of a block of Ant inside GroovyMarkup</span></span><br><span class="line">ant.sequential &#123;</span><br><span class="line">    echo(<span class="string">"inside sequential"</span>)</span><br><span class="line">    <span class="keyword">def</span> myDir = <span class="string">"target/AntTest/"</span></span><br><span class="line">    mkdir(<span class="string">dir:</span> myDir)</span><br><span class="line">    copy(<span class="string">todir:</span> myDir) &#123;</span><br><span class="line">        fileset(<span class="string">dir:</span> <span class="string">"src/test"</span>) &#123;</span><br><span class="line">            include(<span class="string">name:</span> <span class="string">"**/*.groovy"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    echo(<span class="string">"done"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// now lets do some normal Groovy again</span></span><br><span class="line"><span class="keyword">def</span> file = <span class="keyword">new</span> File(ant.project.baseDir,<span class="string">"target/AntTest/groovy/util/AntTest.groovy"</span>)</span><br><span class="line"><span class="keyword">assert</span> file.exists()</span><br></pre></td></tr></table></figure></p>
<p>下面的例子是遍历一组文件, 然后将每个文件根据特殊模式进行匹配.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lets create a scanner of filesets</span></span><br><span class="line"><span class="keyword">def</span> scanner = ant.fileScanner &#123;</span><br><span class="line">    fileset(<span class="string">dir:</span><span class="string">"src/test"</span>) &#123;</span><br><span class="line">        include(<span class="string">name:</span><span class="string">"**/Ant*.groovy"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// now lets iterate over</span></span><br><span class="line"><span class="keyword">def</span> found = <span class="literal">false</span></span><br><span class="line"><span class="keyword">for</span> (f <span class="keyword">in</span> scanner) &#123;</span><br><span class="line">    println(<span class="string">"Found file $f"</span>)</span><br><span class="line">    found = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">assert</span> f <span class="keyword">instanceof</span> File</span><br><span class="line">    <span class="keyword">assert</span> f.name.endsWith(<span class="string">".groovy"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">assert</span> found</span><br></pre></td></tr></table></figure></p>
<p>Or execute a JUnit test:</p>
<p>下面我们执行JUnit<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// lets create a scanner of filesets</span></span><br><span class="line">ant.junit &#123;</span><br><span class="line">    test(<span class="string">name:</span><span class="string">'groovy.util.SomethingThatDoesNotExist'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在, 让我们的步子迈地更大一点：在Groovy中编译然后执行一个Java文件.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ant.echo(<span class="string">file:</span><span class="string">'Temp.java'</span>, <span class="string">'''</span><br><span class="line">    class Temp &#123;</span><br><span class="line">        public static void main(String[] args) &#123;</span><br><span class="line">            System.out.println("Hello");</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">'''</span>)</span><br><span class="line">ant.javac(<span class="string">srcdir:</span><span class="string">'.'</span>, <span class="string">includes:</span><span class="string">'Temp.java'</span>, <span class="string">fork:</span><span class="string">'true'</span>)</span><br><span class="line">ant.java(<span class="string">classpath:</span><span class="string">'.'</span>, <span class="string">classname:</span><span class="string">'Temp'</span>, <span class="string">fork:</span><span class="string">'true'</span>)</span><br><span class="line">ant.echo(<span class="string">'Done'</span>)</span><br></pre></td></tr></table></figure></p>
<p>需要提及的是, <code>AntBuilder</code>是内嵌于<code>Gradle</code>中的. 你可以像在Groovy中那样, 在<code>Gradle</code>使用<code>AntBuilder</code></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Groovy/">Groovy</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/04/08/groovy/groovy ant/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/08/groovy/groovy ant/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/groovy/groovy集合/" title="groovy集合" itemprop="url">groovy集合</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-04-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>本文是对Groovy部分官方文档进行了翻译</p>
</blockquote>
<p>Groovy 语言层面上就支持多种集合类型,包括list, map, range. 大多数类型集合都是基于java的集合框架,而且Groovy development kit对这些集合内置很多快捷方法.</p>
<h3 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h3><p>Groovy使用了一种被<code>[]</code>括起来,值通过<code>,</code>分割的语法 定义list. Groovy list 采用的是 JDK里<code>java.util.List</code>的实现, 因为它自身并没有定义自己的集合类.<br>Groovy list 的默认实现是<code>java.util.ArrayList</code>, 在后面我们可以看到其他形式的list</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]         (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> numbers <span class="keyword">instanceof</span> List  (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> numbers.size() == <span class="number">3</span>      (<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>我们定义了一个Number类型的List,然后将这个list分配给一个变量</li>
<li>判断list是 Java’s <code>java.util.List</code> interface 的实例</li>
<li>list的大小可以通过size()来进行查询, 例子中也给我们展示了这个list确实包含3个元素</li>
</ol>
<p>在上面的list中,我们使用的是同类元素的list, 但其实Groovy list中的数据类型还可以不一样：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> heterogeneous = [<span class="number">1</span>, <span class="string">"a"</span>, <span class="literal">true</span>]  (<span class="number">1</span>)</span><br></pre></td></tr></table></figure></p>
<ol>
<li>我们定义了一个包含有number,string,boolean 三个类型的list</li>
</ol>
<p>在上面我们提到过, list实际上是<code>java.util.ArrayList</code>实例, 但其实list还可以是其他不同类型的实例, 下面我们通过操作符或者显式类型声明来强制指定 list使用不同的List实现<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> arrayList = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> arrayList <span class="keyword">instanceof</span> java.util.ArrayList</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> linkedList = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>] <span class="keyword">as</span> LinkedList    (<span class="number">1</span>)</span><br><span class="line"><span class="keyword">assert</span> linkedList <span class="keyword">instanceof</span> java.util.LinkedList</span><br><span class="line"></span><br><span class="line">LinkedList otherLinked = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]          (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> otherLinked <span class="keyword">instanceof</span> java.util.LinkedList</span><br></pre></td></tr></table></figure></p>
<ol>
<li>我们使用操作符强制将类型显式地声明为<code>java.util.LinkedList</code></li>
<li>我们使用显式声明方式, 将list声明为<code>java.util.LinkedList</code></li>
</ol>
<p>我们可以通过<code>[]</code>下标操作符来访问list中的元素(读写都可以). 下标既如果是正数的话,那就从左到右访问元素, 如果下标是负数那就从右到左访问元素. 我们好可以使用<code>&lt;&lt;</code>操作符向list里追加元素<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> letters = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">0</span>] == <span class="string">'a'</span>     (<span class="number">1</span>)</span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">1</span>] == <span class="string">'b'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">-1</span>] == <span class="string">'d'</span>    (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">-2</span>] == <span class="string">'c'</span></span><br><span class="line"></span><br><span class="line">letters[<span class="number">2</span>] = <span class="string">'C'</span>             (<span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">2</span>] == <span class="string">'C'</span></span><br><span class="line"></span><br><span class="line">letters &lt;&lt; <span class="string">'e'</span>               (<span class="number">4</span>)</span><br><span class="line"><span class="keyword">assert</span> letters[ <span class="number">4</span>] == <span class="string">'e'</span></span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">-1</span>] == <span class="string">'e'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">1</span>, <span class="number">3</span>] == [<span class="string">'b'</span>, <span class="string">'d'</span>]         (<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> letters[<span class="number">2.</span><span class="number">.4</span>] == [<span class="string">'C'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>]    (<span class="number">6</span>)</span><br></pre></td></tr></table></figure></p>
<ol>
<li>访问第一个元素(从这可以看出,list的下标是从0开始的)</li>
<li>通过-1 下标访问list中的最后一个元素.</li>
<li>使用下标对list中第三个元素重新赋值</li>
<li>使用<code>&lt;&lt;</code>向list尾部添加一个元素</li>
<li>一次性访问list中俩个元素,这个操作的结果是返回一个包含俩个元素的新的list</li>
<li>使用值域符来访问list中一定范围内的值.</li>
</ol>
<p>由于list支持多种不同类型的元素, 那么list中也可以包含list,这样就可以制造出多维list<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> multi = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>]]     (<span class="number">1</span>)</span><br><span class="line"><span class="keyword">assert</span> multi[<span class="number">1</span>][<span class="number">0</span>] == <span class="number">2</span>          (<span class="number">2</span>)</span><br></pre></td></tr></table></figure></p>
<ol>
<li>定义了一个包含Number类型list的list</li>
<li>访问外层的第二个元素(第二个list), 然后访问内部list的第一个元素(第二个list的第一个元素)</li>
</ol>
<h4 id="List-literals"><a href="#List-literals" class="headerlink" title="List literals"></a>List literals</h4><p>你可以像下面这样创建集合, 注意<code>[]</code>是空集合表达式.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">assert</span> list.get(<span class="number">2</span>) == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> list[<span class="number">2</span>] == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> list <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> emptyList = []</span><br><span class="line"><span class="keyword">assert</span> emptyList.size() == <span class="number">0</span></span><br><span class="line">emptyList.add(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> emptyList.size() == <span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>每一个list表达式都是实现自<code>java.util.List</code></p>
<p>当然list也可以指定其具体的实现类型<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list1 = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>]</span><br><span class="line"><span class="comment">//construct a new list, seeded with the same items as in list1</span></span><br><span class="line"><span class="keyword">def</span> list2 = <span class="keyword">new</span> ArrayList&lt;String&gt;(list1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list2 == list1 <span class="comment">// == checks that each corresponding element is the same</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// clone() can also be called</span></span><br><span class="line"><span class="keyword">def</span> list3 = list1.clone()</span><br><span class="line"><span class="keyword">assert</span> list3 == list1</span><br></pre></td></tr></table></figure></p>
<p>list本质上是一个有序的对象集合.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">assert</span> list.size() == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> list.getClass() == ArrayList     <span class="comment">// the specific kind of list being used</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list[<span class="number">2</span>] == <span class="number">7</span>                     <span class="comment">// indexing starts at 0</span></span><br><span class="line"><span class="keyword">assert</span> list.getAt(<span class="number">2</span>) == <span class="number">7</span>               <span class="comment">// equivalent method to subscript operator []</span></span><br><span class="line"><span class="keyword">assert</span> list.get(<span class="number">2</span>) == <span class="number">7</span>                 <span class="comment">// alternative method</span></span><br><span class="line"></span><br><span class="line">list[<span class="number">2</span>] = <span class="number">9</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>,]           <span class="comment">// trailing comma OK</span></span><br><span class="line"></span><br><span class="line">list.putAt(<span class="number">2</span>, <span class="number">10</span>)                       <span class="comment">// equivalent method to [] when value being changed</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">assert</span> list.set(<span class="number">2</span>, <span class="number">11</span>) == <span class="number">10</span>            <span class="comment">// alternative method that returns old value</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="number">1</span>, <span class="string">'a'</span>, <span class="string">'a'</span>, <span class="number">2.5</span>, <span class="number">2.5</span>f, <span class="number">2.5</span>d, <span class="string">'hello'</span>, <span class="number">7</span>g, <span class="literal">null</span>, <span class="number">9</span> <span class="keyword">as</span> <span class="keyword">byte</span>]</span><br><span class="line"><span class="comment">//objects can be of different types; duplicates allowed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>][<span class="number">-1</span>] == <span class="number">5</span>             <span class="comment">// use negative indices to count from the end</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>][<span class="number">-2</span>] == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].getAt(<span class="number">-2</span>) == <span class="number">4</span>       <span class="comment">// getAt() available with negative index...</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].get(<span class="number">-2</span>)                 <span class="comment">// but negative index not allowed with get()</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="literal">false</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="keyword">assert</span> e <span class="keyword">instanceof</span> ArrayIndexOutOfBoundsException</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="List-as-a-boolean-expression"><a href="#List-as-a-boolean-expression" class="headerlink" title="List as a boolean expression"></a>List as a boolean expression</h4><p>list还可以计算出boolean表达式.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> ![]             <span class="comment">// an empty list evaluates as false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//all other lists, irrespective of contents, evaluate as true</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>] &amp;&amp; [<span class="string">'a'</span>] &amp;&amp; [<span class="number">0</span>] &amp;&amp; [<span class="number">0.0</span>] &amp;&amp; [<span class="literal">false</span>] &amp;&amp; [<span class="literal">null</span>]</span><br></pre></td></tr></table></figure></p>
<h4 id="Iterating-on-a-list"><a href="#Iterating-on-a-list" class="headerlink" title="Iterating on a list"></a>Iterating on a list</h4><p>可以通过<code>each</code>, <code>eachWithIndex</code>遍历整个集合.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].each &#123;</span><br><span class="line">    println <span class="string">"Item: $it"</span> <span class="comment">// `it` is an implicit parameter corresponding to the current element</span></span><br><span class="line">&#125;</span><br><span class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].eachWithIndex &#123; it, i -&gt; <span class="comment">// `it` is the current element, while `i` is the index</span></span><br><span class="line">    println <span class="string">"$i: $it"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在遍历的时候,我们经常需要将遍历出来的值经过某些运算,然后再重新放进一个新的list中. 这种操作经常称为映射(mapping), 这种操作通过<code>collect</code>方法实现.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].collect &#123; it * <span class="number">2</span> &#125; == [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// shortcut syntax instead of collect</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]*.multiply(<span class="number">2</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].collect &#123; it.multiply(<span class="number">2</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">0</span>]</span><br><span class="line"><span class="comment">// it is possible to give `collect` the list which collects the elements</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].collect(list) &#123; it * <span class="number">2</span> &#125; == [<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure></p>
<h4 id="Manipulating-lists"><a href="#Manipulating-lists" class="headerlink" title="Manipulating lists"></a>Manipulating lists</h4><h5 id="Filtering-and-searching"><a href="#Filtering-and-searching" class="headerlink" title="Filtering and searching"></a>Filtering and searching</h5><p><a href="http://www.groovy-lang.org/gdk.html" target="_blank" rel="external">Groovy development kit</a>提供了许多强大有趣的方法用来强化标准集合:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].find &#123; it &gt; <span class="number">1</span> &#125; == <span class="number">2</span>           <span class="comment">// find 1st element matching criteria</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].findAll &#123; it &gt; <span class="number">1</span> &#125; == [<span class="number">2</span>, <span class="number">3</span>]   <span class="comment">// find all elements matching critieria</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>].findIndexOf &#123;      <span class="comment">// find index of 1st element matching criteria</span></span><br><span class="line">    it <span class="keyword">in</span> [<span class="string">'c'</span>, <span class="string">'e'</span>, <span class="string">'g'</span>]</span><br><span class="line">&#125; == <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>].indexOf(<span class="string">'c'</span>) == <span class="number">2</span>  <span class="comment">// index returned</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>].indexOf(<span class="string">'z'</span>) == <span class="number">-1</span> <span class="comment">// index -1 means value not in list</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'c'</span>].lastIndexOf(<span class="string">'c'</span>) == <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].every &#123; it &lt; <span class="number">5</span> &#125;               <span class="comment">// returns true if all elements match the predicate</span></span><br><span class="line"><span class="keyword">assert</span> ![<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].every &#123; it &lt; <span class="number">3</span> &#125;</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].any &#123; it &gt; <span class="number">2</span> &#125;                 <span class="comment">// returns true if any element matches the predicate</span></span><br><span class="line"><span class="keyword">assert</span> ![<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].any &#123; it &gt; <span class="number">3</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>].sum() == <span class="number">21</span>                <span class="comment">// sum anything with a plus() method</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>].sum &#123;</span><br><span class="line">    it == <span class="string">'a'</span> ? 1 : it == <span class="string">'b'</span> ? 2 : it == <span class="string">'c'</span> ? 3 : it == <span class="string">'d'</span> ? 4 : it == <span class="string">'e'</span> ? 5 : <span class="number">0</span></span><br><span class="line">    <span class="comment">// custom value to use in sum</span></span><br><span class="line">&#125; == <span class="number">15</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>].sum &#123; ((<span class="keyword">char</span>) it) - ((<span class="keyword">char</span>) <span class="string">'a'</span>) &#125; == <span class="number">10</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>, <span class="string">'e'</span>].sum() == <span class="string">'abcde'</span></span><br><span class="line"><span class="keyword">assert</span> [[<span class="string">'a'</span>, <span class="string">'b'</span>], [<span class="string">'c'</span>, <span class="string">'d'</span>]].sum() == [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// an initial value can be provided</span></span><br><span class="line"><span class="keyword">assert</span> [].sum(<span class="number">1000</span>) == <span class="number">1000</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].sum(<span class="number">1000</span>) == <span class="number">1006</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].join(<span class="string">'-'</span>) == <span class="string">'1-2-3'</span>           <span class="comment">// String joining</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].inject(<span class="string">'counting: '</span>) &#123;</span><br><span class="line">    str, item -&gt; str + item                     <span class="comment">// reduce operation</span></span><br><span class="line">&#125; == <span class="string">'counting: 123'</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].inject(<span class="number">0</span>) &#123; count, item -&gt;</span><br><span class="line">    count + item</span><br><span class="line">&#125; == <span class="number">6</span></span><br></pre></td></tr></table></figure>
<p>下面这段代码是由Groovy语言支撑的在集合中找到最大和最小数的例子:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">9</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">10</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">assert</span> list.max() == <span class="number">10</span></span><br><span class="line"><span class="keyword">assert</span> list.min() == <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// we can also compare single characters, as anything comparable</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'a'</span>, <span class="string">'z'</span>].min() == <span class="string">'a'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// we can use a closure to specify the sorting behaviour</span></span><br><span class="line"><span class="keyword">def</span> list2 = [<span class="string">'abc'</span>, <span class="string">'z'</span>, <span class="string">'xyzuvw'</span>, <span class="string">'Hello'</span>, <span class="string">'321'</span>]</span><br><span class="line"><span class="keyword">assert</span> list2.max &#123; it.size() &#125; == <span class="string">'xyzuvw'</span></span><br><span class="line"><span class="keyword">assert</span> list2.min &#123; it.size() &#125; == <span class="string">'z'</span></span><br></pre></td></tr></table></figure></p>
<p>在闭包里,你还可以自定义一个比较规则.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Comparator mc = &#123; a, b -&gt; a == b ? 0 : (a &lt; b ? -1 : <span class="number">1</span>) &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">-6</span>, <span class="number">-1</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-9</span>, <span class="number">5</span>, <span class="number">-13</span>]</span><br><span class="line"><span class="keyword">assert</span> list.max(mc) == <span class="number">11</span></span><br><span class="line"><span class="keyword">assert</span> list.min(mc) == <span class="number">-13</span></span><br><span class="line"></span><br><span class="line">Comparator mc2 = &#123; a, b -&gt; a == b ? 0 : (Math.abs(a) &lt; Math.abs(b)) ? -1 : <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list.max(mc2) == <span class="number">-13</span></span><br><span class="line"><span class="keyword">assert</span> list.min(mc2) == <span class="number">-1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> list.max &#123; a, b -&gt; a.equals(b) ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : <span class="number">1</span> &#125; == <span class="number">-13</span></span><br><span class="line"><span class="keyword">assert</span> list.min &#123; a, b -&gt; a.equals(b) ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : <span class="number">1</span> &#125; == <span class="number">-1</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Adding-or-removing-elements"><a href="#Adding-or-removing-elements" class="headerlink" title="Adding or removing elements"></a>Adding or removing elements</h5><p>我们可以使用<code>[]</code>去声明一个新的空list, 然后使用<code>&lt;&lt;</code>向list追加元素<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = []</span><br><span class="line"><span class="keyword">assert</span> list.empty</span><br><span class="line"></span><br><span class="line">list &lt;&lt; <span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> list.size() == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">list &lt;&lt; <span class="number">7</span> &lt;&lt; <span class="string">'i'</span> &lt;&lt; <span class="number">11</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">7</span>, <span class="string">'i'</span>, <span class="number">11</span>]</span><br><span class="line"></span><br><span class="line">list &lt;&lt; [<span class="string">'m'</span>, <span class="string">'o'</span>]</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">5</span>, <span class="number">7</span>, <span class="string">'i'</span>, <span class="number">11</span>, [<span class="string">'m'</span>, <span class="string">'o'</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment">//first item in chain of &lt;&lt; is target list</span></span><br><span class="line"><span class="keyword">assert</span> ([<span class="number">1</span>, <span class="number">2</span>] &lt;&lt; <span class="number">3</span> &lt;&lt; [<span class="number">4</span>, <span class="number">5</span>] &lt;&lt; <span class="number">6</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>], <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//using leftShift is equivalent to using &lt;&lt;</span></span><br><span class="line"><span class="keyword">assert</span> ([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] &lt;&lt; <span class="number">4</span>) == ([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].leftShift(<span class="number">4</span>))</span><br><span class="line">```groovy</span><br><span class="line">We can add to a list <span class="keyword">in</span> many <span class="string">ways:</span></span><br><span class="line">```groovy</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>] + <span class="number">3</span> + [<span class="number">4</span>, <span class="number">5</span>] + <span class="number">6</span> == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="comment">// equivalent to calling the `plus` method</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>].plus(<span class="number">3</span>).plus([<span class="number">4</span>, <span class="number">5</span>]).plus(<span class="number">6</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">a += <span class="number">4</span>      <span class="comment">// creates a new list and assigns it to `a`</span></span><br><span class="line">a += [<span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="keyword">assert</span> a == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, *[<span class="number">222</span>, <span class="number">333</span>], <span class="number">456</span>] == [<span class="number">1</span>, <span class="number">222</span>, <span class="number">333</span>, <span class="number">456</span>]</span><br><span class="line"><span class="keyword">assert</span> [*[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]] == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>, [<span class="number">4</span>, <span class="number">5</span>], <span class="number">6</span>], <span class="number">7</span>, [<span class="number">8</span>, <span class="number">9</span>]].flatten() == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">list.add(<span class="number">3</span>)</span><br><span class="line">list.addAll([<span class="number">5</span>, <span class="number">4</span>])</span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">list = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">list.add(<span class="number">1</span>, <span class="number">3</span>) <span class="comment">// add 3 just before index 1</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">list.addAll(<span class="number">2</span>, [<span class="number">5</span>, <span class="number">4</span>]) <span class="comment">//add [5,4] just before index 2</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">list = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'z'</span>, <span class="string">'e'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'g'</span>]</span><br><span class="line">list[<span class="number">8</span>] = <span class="string">'x'</span> <span class="comment">// the [] operator is growing the list as needed</span></span><br><span class="line"><span class="comment">// nulls inserted if required</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'z'</span>, <span class="string">'e'</span>, <span class="string">'u'</span>, <span class="string">'v'</span>, <span class="string">'g'</span>, <span class="literal">null</span>, <span class="string">'x'</span>]</span><br></pre></td></tr></table></figure></p>
<p>在list中<code>+</code>的语义并没有发生变化,这是何等的重要啊~~~ 与<code>&lt;&lt;</code>相比, <code>+</code>会创建一个新的list,  但是这个创建的list很可能不是你所预期的, 而且这种方式也可能会导致一些性能问题.</p>
<p><code>Groovy development kit</code>同样提供了很多便捷的方式从list里删除元素:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>] - <span class="string">'c'</span> == [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>] - <span class="string">'b'</span> == [<span class="string">'a'</span>,<span class="string">'c'</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>] - [<span class="string">'b'</span>,<span class="string">'c'</span>] == [<span class="string">'a'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line">list -= <span class="number">3</span>           <span class="comment">// creates a new list by removing `3` from the original one</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> ( list -= [<span class="number">2</span>,<span class="number">4</span>] ) == [<span class="number">1</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure></p>
<p>同样,你也能通过索引的方式从list里删除元素.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> list.remove(<span class="number">2</span>) == <span class="number">3</span>          <span class="comment">// remove the third element, and return it</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br></pre></td></tr></table></figure></p>
<p>假设,你如果从list中删除多个相同元素中的第一个, 那你可以调用<code>remove</code>方法.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list= [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>]</span><br><span class="line"><span class="keyword">assert</span> list.remove(<span class="string">'c'</span>)             <span class="comment">// remove 'c', and return true because element removed</span></span><br><span class="line"><span class="keyword">assert</span> list.remove(<span class="string">'b'</span>)             <span class="comment">// remove first 'b', and return true because element removed</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> ! list.remove(<span class="string">'z'</span>)           <span class="comment">// return false because no elements removed</span></span><br><span class="line"><span class="keyword">assert</span> list == [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>]</span><br></pre></td></tr></table></figure></p>
<p>如果你想要将list清空的话,只需要调用<code>clear</code>方法即可<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> list= [<span class="string">'a'</span>,<span class="number">2</span>,<span class="string">'c'</span>,<span class="number">4</span>]</span><br><span class="line">list.clear()</span><br><span class="line"><span class="keyword">assert</span> list == []</span><br></pre></td></tr></table></figure></p>
<h5 id="Set-operations"><a href="#Set-operations" class="headerlink" title="Set operations"></a>Set operations</h5><p><code>Groovy development kit</code>还包含很多逻辑运算的方法<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="string">'a'</span> <span class="keyword">in</span> [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]             <span class="comment">// returns true if an element belongs to the list</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>].contains(<span class="string">'a'</span>)      <span class="comment">// equivalent to the `contains` method in Java</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>].containsAll([<span class="number">1</span>,<span class="number">4</span>])       <span class="comment">// `containsAll` will check that all elements are found</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].count(<span class="number">3</span>) == <span class="number">4</span>  <span class="comment">// count the number of elements which have some value</span></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>].count &#123;</span><br><span class="line">    it%<span class="number">2</span>==<span class="number">0</span>                             <span class="comment">// count the number of elements which match the predicate</span></span><br><span class="line">&#125; == <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">12</span>].intersect([<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">12</span>]) == [<span class="number">1</span>,<span class="number">6</span>,<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].disjoint( [<span class="number">4</span>,<span class="number">6</span>,<span class="number">9</span>] )</span><br><span class="line"><span class="keyword">assert</span> ![<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].disjoint( [<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>] )</span><br></pre></td></tr></table></figure></p>
<h5 id="Sorting"><a href="#Sorting" class="headerlink" title="Sorting"></a>Sorting</h5><p>Groovy还提供了很多使用闭包比较器的排序操作<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">6</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>].sort() == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list = [<span class="string">'abc'</span>, <span class="string">'z'</span>, <span class="string">'xyzuvw'</span>, <span class="string">'Hello'</span>, <span class="string">'321'</span>]</span><br><span class="line"><span class="keyword">assert</span> list.sort &#123;</span><br><span class="line">    it.size()</span><br><span class="line">&#125; == [<span class="string">'z'</span>, <span class="string">'abc'</span>, <span class="string">'321'</span>, <span class="string">'Hello'</span>, <span class="string">'xyzuvw'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list2 = [<span class="number">7</span>, <span class="number">4</span>, <span class="number">-6</span>, <span class="number">-1</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">-9</span>, <span class="number">5</span>, <span class="number">-13</span>]</span><br><span class="line"><span class="keyword">assert</span> list2.sort &#123; a, b -&gt; a == b ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : <span class="number">1</span> &#125; ==</span><br><span class="line">        [<span class="number">-1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">-6</span>, <span class="number">7</span>, <span class="number">-9</span>, <span class="number">11</span>, <span class="number">-13</span>]</span><br><span class="line"></span><br><span class="line">Comparator mc = &#123; a, b -&gt; a == b ? 0 : Math.abs(a) &lt; Math.abs(b) ? -1 : <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// JDK 8+ only</span></span><br><span class="line"><span class="comment">// list2.sort(mc)</span></span><br><span class="line"><span class="comment">// assert list2 == [-1, 2, 3, 4, 5, -6, 7, -9, 11, -13]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> list3 = [<span class="number">6</span>, <span class="number">-3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">-7</span>, <span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">Collections.sort(list3)</span><br><span class="line"><span class="keyword">assert</span> list3 == [<span class="number">-7</span>, <span class="number">-3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">Collections.sort(list3, mc)</span><br><span class="line"><span class="keyword">assert</span> list3 == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">-3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">-7</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure></p>
<h5 id="Duplicating-elements"><a href="#Duplicating-elements" class="headerlink" title="Duplicating elements"></a>Duplicating elements</h5><p><code>roovy development kit</code>还通过重载操作符的方式, 内部提供了一些方法进行list元素复制.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] * <span class="number">3</span> == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].multiply(<span class="number">2</span>) == [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">assert</span> Collections.nCopies(<span class="number">3</span>, <span class="string">'b'</span>) == [<span class="string">'b'</span>, <span class="string">'b'</span>, <span class="string">'b'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// nCopies from the JDK has different semantics than multiply for lists</span></span><br><span class="line"><span class="keyword">assert</span> Collections.nCopies(<span class="number">2</span>, [<span class="number">1</span>, <span class="number">2</span>]) == [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">2</span>]] <span class="comment">//not [1,2,1,2]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h3><p>Groovy 数组重用了list符号, 但是如果想要创建数组, 那么就必须强制地显式定义数组类型<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String[] arrStr = [<span class="string">'Ananas'</span>, <span class="string">'Banana'</span>, <span class="string">'Kiwi'</span>]  (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> arrStr <span class="keyword">instanceof</span> String[]    (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> !(arrStr <span class="keyword">instanceof</span> List)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> numArr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] <span class="keyword">as</span> <span class="keyword">int</span>[]      (<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> numArr <span class="keyword">instanceof</span> <span class="keyword">int</span>[]       (<span class="number">4</span>)</span><br><span class="line"><span class="keyword">assert</span> numArr.size() == <span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<ol>
<li>使用显式变量类型定义了一个字符串数组</li>
<li>断言刚才创建的数组是否是string类型</li>
<li>使用操作符定义一个int数组</li>
<li>断言刚才创建的数组是否是int类型</li>
</ol>
<p>我们也可以创建出一个多维数组<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> matrix3 = <span class="keyword">new</span> Integer[<span class="number">3</span>][<span class="number">3</span>]         (<span class="number">1</span>)</span><br><span class="line"><span class="keyword">assert</span> matrix3.size() == <span class="number">3</span></span><br><span class="line"></span><br><span class="line">Integer[][] matrix2                     (<span class="number">2</span>)</span><br><span class="line">matrix2 = [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]]</span><br><span class="line"><span class="keyword">assert</span> matrix2 <span class="keyword">instanceof</span> Integer[][]</span><br></pre></td></tr></table></figure></p>
<ol>
<li>我们指定了新数组的边界</li>
<li>当然我们也可以不指定它的边界</li>
</ol>
<p>访问数组元素和访问list元素的方式相同<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String[] names = [<span class="string">'Cédric'</span>, <span class="string">'Guillaume'</span>, <span class="string">'Jochen'</span>, <span class="string">'Paul'</span>]</span><br><span class="line"><span class="keyword">assert</span> names[<span class="number">0</span>] == <span class="string">'Cédric'</span>     (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">names[<span class="number">2</span>] = <span class="string">'Blackdrag'</span>          (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> names[<span class="number">2</span>] == <span class="string">'Blackdrag'</span></span><br></pre></td></tr></table></figure></p>
<p>1    Retrieve the first element of the array<br>2    Set the value of the third element of the array to a new value</p>
<ol>
<li>检索数组中第一个元素</li>
<li>对数组中第三个元素重新赋值</li>
</ol>
<p>Groovy不支持Java数组初始化语法, 因为Java数组中的花括号可能被会Groovy无解成闭包</p>
<h3 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h3><p>有时候我们在其他语言中称map为 字典或者关联数组. Map将key和value关联起来, 在Groovy中map被<code>[]</code>括起来, 通过<code>,</code>分割键值对, 键值通过<code>:</code>分割<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> colors = [<span class="string">red:</span> <span class="string">'#FF0000'</span>, <span class="string">green:</span> <span class="string">'#00FF00'</span>, <span class="string">blue:</span> <span class="string">'#0000FF'</span>]   (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> colors[<span class="string">'red'</span>] == <span class="string">'#FF0000'</span>    (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> colors.green  == <span class="string">'#00FF00'</span>    (<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">colors[<span class="string">'pink'</span>] = <span class="string">'#FF00FF'</span>           (<span class="number">4</span>)</span><br><span class="line">colors.yellow  = <span class="string">'#FFFF00'</span>           (<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> colors.pink == <span class="string">'#FF00FF'</span></span><br><span class="line"><span class="keyword">assert</span> colors[<span class="string">'yellow'</span>] == <span class="string">'#FFFF00'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> colors <span class="keyword">instanceof</span> java.util.LinkedHashMap</span><br></pre></td></tr></table></figure></p>
<ol>
<li>我们定义了一个string类型的代表颜色名字的数组,</li>
<li>然后使用下标来检索map中是否包含red这个key</li>
<li>我们还可以直接使用<code>.</code>来索引到某个key</li>
<li>我们可以使用下标向map中添加一个新的键值对</li>
<li>我们也可以使用<code>.</code>添加一个新的键值对</li>
</ol>
<p>Groovy创建的map类型默认的是<code>java.util.LinkedHashMap</code></p>
<p>当你想要访问一个不存在的key时：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> colors.unknown == <span class="literal">null</span></span><br></pre></td></tr></table></figure></p>
<p>你将检索出一个null的结果</p>
<p>在上面的例子中我们使用的是以string作为key, 但是你还可以使用其他类型作为map的key：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> numbers = [<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> numbers[<span class="number">1</span>] == <span class="string">'one'</span></span><br></pre></td></tr></table></figure>
<p>我们使用了number作为了map新的key类型, number类型就会直接被解释为number类型, 因此Groovy不会像先前那样创建一个string类型的key. 但是假设你想要传递一个变量作为key,是变量的值作为key：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> key = <span class="string">'name'</span></span><br><span class="line"><span class="keyword">def</span> person = [<span class="string">key:</span> <span class="string">'Guillaume'</span>]      (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> !person.containsKey(<span class="string">'name'</span>)   (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> person.containsKey(<span class="string">'key'</span>)     (<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>与<code>\&#39;Guillaume&#39;</code> 关联的key实际上是<code>&quot;key&quot;</code>这个字符串, 而不是这个key的引用值<code>&#39;name&#39;</code></li>
<li>map中不包含<code>&#39;name&#39;</code>key</li>
<li>取而代之的是map中包含一个<code>&quot;key&quot;</code>的字符串</li>
</ol>
<p>你可以向map中传递一个引号字符串作为key,例如<code>[&quot;name&quot;: &quot;Guillaume&quot;]</code>.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person = [(key): <span class="string">'Guillaume'</span>]        (<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> person.containsKey(<span class="string">'name'</span>)    (<span class="number">2</span>)</span><br><span class="line"><span class="keyword">assert</span> !person.containsKey(<span class="string">'key'</span>)    (<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>1    This time, we surround the key variable with parentheses, to instruct the parser we are passing a variable rather than defining a string key<br>2    The map does contain the name key<br>3    But the map doesn’t contain the key key as before<br>1.<br>2.<br>3.</p>
<h4 id="Map-literals"><a href="#Map-literals" class="headerlink" title="Map literals"></a>Map literals</h4><p>在Groovy中可以使用<code>[:]</code> 创建一个map.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="string">name:</span> <span class="string">'Gromit'</span>, <span class="string">likes:</span> <span class="string">'cheese'</span>, <span class="string">id:</span> <span class="number">1234</span>]</span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">'name'</span>) == <span class="string">'Gromit'</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">'id'</span>) == <span class="number">1234</span></span><br><span class="line"><span class="keyword">assert</span> map[<span class="string">'name'</span>] == <span class="string">'Gromit'</span></span><br><span class="line"><span class="keyword">assert</span> map[<span class="string">'id'</span>] == <span class="number">1234</span></span><br><span class="line"><span class="keyword">assert</span> map <span class="keyword">instanceof</span> java.util.Map</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> emptyMap = [:]</span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">0</span></span><br><span class="line">emptyMap.put(<span class="string">"foo"</span>, <span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> emptyMap.get(<span class="string">"foo"</span>) == <span class="number">5</span></span><br></pre></td></tr></table></figure></p>
<p>Map的key默认是<code>string</code>, 例如<code>[a:1]</code>等同于<code>[&#39;a&#39;:1]</code>. 比较荣誉造成疑惑的就是,如果你创建了一个变量a(值为b), 但是你将变量a<code>put</code>进map后, map的key会是a,而不是b. 如果你遇到了这个情况的话,那么你必须对使用<code>()</code>key进行转义了.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> a = <span class="string">'Bob'</span></span><br><span class="line"><span class="keyword">def</span> ages = [<span class="string">a:</span> <span class="number">43</span>]</span><br><span class="line"><span class="keyword">assert</span> ages[<span class="string">'Bob'</span>] == <span class="literal">null</span> <span class="comment">// `Bob` is not found</span></span><br><span class="line"><span class="keyword">assert</span> ages[<span class="string">'a'</span>] == <span class="number">43</span>     <span class="comment">// because `a` is a literal!</span></span><br><span class="line"></span><br><span class="line">ages = [(a): <span class="number">43</span>]            <span class="comment">// now we escape `a` by using parenthesis</span></span><br><span class="line"><span class="keyword">assert</span> ages[<span class="string">'Bob'</span>] == <span class="number">43</span>   <span class="comment">// and the value is found!</span></span><br></pre></td></tr></table></figure></p>
<p>通过下面的方式你可以轻松克隆一个map<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [</span><br><span class="line">        <span class="string">simple :</span> <span class="number">123</span>,</span><br><span class="line"><span class="symbol">        complex:</span> [<span class="string">a:</span> <span class="number">1</span>, <span class="string">b:</span> <span class="number">2</span>]</span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> map2 = map.clone()</span><br><span class="line"><span class="keyword">assert</span> map2.get(<span class="string">'simple'</span>) == map.get(<span class="string">'simple'</span>)</span><br><span class="line"><span class="keyword">assert</span> map2.get(<span class="string">'complex'</span>) == map.get(<span class="string">'complex'</span>)</span><br><span class="line">map2.get(<span class="string">'complex'</span>).put(<span class="string">'c'</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">'complex'</span>).get(<span class="string">'c'</span>) == <span class="number">3</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Map-property-notation"><a href="#Map-property-notation" class="headerlink" title="Map property notation"></a>Map property notation</h4><p>Maps和beans也是非常相像的, 所以你可以对map使用<code>get/set</code>操作元素,当然这也有个前提,那就是map中的key必须是符合Groovy标识符的key.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="string">name:</span> <span class="string">'Gromit'</span>, <span class="string">likes:</span> <span class="string">'cheese'</span>, <span class="string">id:</span> <span class="number">1234</span>]</span><br><span class="line"><span class="keyword">assert</span> map.name == <span class="string">'Gromit'</span>     <span class="comment">// can be used instead of map.get('Gromit')</span></span><br><span class="line"><span class="keyword">assert</span> map.id == <span class="number">1234</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> emptyMap = [:]</span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">0</span></span><br><span class="line">emptyMap.foo = <span class="number">5</span></span><br><span class="line"><span class="keyword">assert</span> emptyMap.size() == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> emptyMap.foo == <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>注意:<code>map.foo</code>总是会在map中查找key<code>foo</code>. 这意味着,<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="string">name:</span> <span class="string">'Gromit'</span>, <span class="string">likes:</span> <span class="string">'cheese'</span>, <span class="string">id:</span> <span class="number">1234</span>]</span><br><span class="line"><span class="keyword">assert</span> map.<span class="keyword">class</span> == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">'class'</span>) == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.getClass() == LinkedHashMap <span class="comment">// this is probably what you want</span></span><br><span class="line"></span><br><span class="line">map = [<span class="number">1</span>      : <span class="string">'a'</span>,</span><br><span class="line">       (<span class="literal">true</span>) : <span class="string">'p'</span>,</span><br><span class="line">       (<span class="literal">false</span>): <span class="string">'q'</span>,</span><br><span class="line">       (<span class="literal">null</span>) : <span class="string">'x'</span>,</span><br><span class="line">       <span class="string">'null'</span> : <span class="string">'z'</span>]</span><br><span class="line"><span class="keyword">assert</span> map.containsKey(<span class="number">1</span>) <span class="comment">// 1 is not an identifier so used as is</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="literal">true</span> == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="literal">false</span> == <span class="literal">null</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="literal">true</span>) == <span class="string">'p'</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="literal">false</span>) == <span class="string">'q'</span></span><br><span class="line"><span class="keyword">assert</span> map.<span class="literal">null</span> == <span class="string">'z'</span></span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="literal">null</span>) == <span class="string">'x'</span></span><br></pre></td></tr></table></figure></p>
<h4 id="Iterating-on-maps"><a href="#Iterating-on-maps" class="headerlink" title="Iterating on maps"></a>Iterating on maps</h4><p><code>Groovy development kit</code>还提供了<code>eachWithIndex</code>方法遍历map.值得注意的是,map会保留put元素的顺序,也就是说,当你遍历一个map的时候,无论进行多少次,你获得的元素的顺序是一定的.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [</span><br><span class="line">        <span class="string">Bob  :</span> <span class="number">42</span>,</span><br><span class="line"><span class="symbol">        Alice:</span> <span class="number">54</span>,</span><br><span class="line">        <span class="string">Max  :</span> <span class="number">33</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// `entry` is a map entry</span></span><br><span class="line">map.each &#123; entry -&gt;</span><br><span class="line">    println <span class="string">"Name: $entry.key Age: $entry.value"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `entry` is a map entry, `i` the index in the map</span></span><br><span class="line">map.eachWithIndex &#123; entry, i -&gt;</span><br><span class="line">    println <span class="string">"$i - Name: $entry.key Age: $entry.value"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Alternatively you can use key and value directly</span></span><br><span class="line">map.each &#123; key, value -&gt;</span><br><span class="line">    println <span class="string">"Name: $key Age: $value"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Key, value and i as the index in the map</span></span><br><span class="line">map.eachWithIndex &#123; key, value, i -&gt;</span><br><span class="line">    println <span class="string">"$i - Name: $key Age: $value"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="Manipulating-maps"><a href="#Manipulating-maps" class="headerlink" title="Manipulating maps"></a>Manipulating maps</h4><h5 id="Adding-or-removing-elements-1"><a href="#Adding-or-removing-elements-1" class="headerlink" title="Adding or removing elements"></a>Adding or removing elements</h5><p>向map中添加元素你可以使用<code>put</code>方法, <code>下标</code>, <code>putAll</code>方法.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> defaults = [<span class="number">1</span>: <span class="string">'a'</span>, <span class="number">2</span>: <span class="string">'b'</span>, <span class="number">3</span>: <span class="string">'c'</span>, <span class="number">4</span>: <span class="string">'d'</span>]</span><br><span class="line"><span class="keyword">def</span> overrides = [<span class="number">2</span>: <span class="string">'z'</span>, <span class="number">5</span>: <span class="string">'x'</span>, <span class="number">13</span>: <span class="string">'x'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> result = <span class="keyword">new</span> LinkedHashMap(defaults)</span><br><span class="line">result.put(<span class="number">15</span>, <span class="string">'t'</span>)</span><br><span class="line">result[<span class="number">17</span>] = <span class="string">'u'</span></span><br><span class="line">result.putAll(overrides)</span><br><span class="line"><span class="keyword">assert</span> result == [<span class="number">1</span>: <span class="string">'a'</span>, <span class="number">2</span>: <span class="string">'z'</span>, <span class="number">3</span>: <span class="string">'c'</span>, <span class="number">4</span>: <span class="string">'d'</span>, <span class="number">5</span>: <span class="string">'x'</span>, <span class="number">13</span>: <span class="string">'x'</span>, <span class="number">15</span>: <span class="string">'t'</span>, <span class="number">17</span>: <span class="string">'u'</span>]</span><br></pre></td></tr></table></figure></p>
<p>如果想要删除map中全部的元素,可以使用<code>clear</code>方法.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> m = [<span class="number">1</span>:<span class="string">'a'</span>, <span class="number">2</span>:<span class="string">'b'</span>]</span><br><span class="line"><span class="keyword">assert</span> m.get(<span class="number">1</span>) == <span class="string">'a'</span></span><br><span class="line">m.clear()</span><br><span class="line"><span class="keyword">assert</span> m == [:]</span><br></pre></td></tr></table></figure></p>
<p>通过map字面量标记创建的map会使用<code>object</code>的<code>equals</code>方法和<code>hashcode</code>方法.</p>
<p>还要注意的是,不要使用GString作为map的key, 因为GString的hashcode方法和String的hashcode方法不一样.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> key = <span class="string">'some key'</span></span><br><span class="line"><span class="keyword">def</span> map = [:]</span><br><span class="line"><span class="keyword">def</span> gstringKey = <span class="string">"$&#123;key.toUpperCase()&#125;"</span></span><br><span class="line">map.put(gstringKey,<span class="string">'value'</span>)</span><br><span class="line"><span class="keyword">assert</span> map.get(<span class="string">'SOME KEY'</span>) == <span class="literal">null</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Keys-values-and-entries"><a href="#Keys-values-and-entries" class="headerlink" title="Keys, values and entries"></a>Keys, values and entries</h5><p>我们可以在视图中inspect<code>keys, values, and entries</code><br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> map = [<span class="number">1</span>:<span class="string">'a'</span>, <span class="number">2</span>:<span class="string">'b'</span>, <span class="number">3</span>:<span class="string">'c'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> entries = map.entrySet()</span><br><span class="line">entries.each &#123; entry -&gt;</span><br><span class="line">  <span class="keyword">assert</span> entry.key <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">  <span class="keyword">assert</span> entry.value <span class="keyword">in</span> [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> keys = map.keySet()</span><br><span class="line"><span class="keyword">assert</span> keys == [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] <span class="keyword">as</span> Set</span><br></pre></td></tr></table></figure></p>
<p>Mutating values returned by the view (be it a map entry, a key or a value) is highly discouraged because success of the operation directly depends on the type of the map being manipulated. In particular, Groovy relies on collections from the JDK that in general make no guarantee that a collection can safely be manipulated through keySet, entrySet, or values.</p>
<h5 id="Filtering-and-searching-1"><a href="#Filtering-and-searching-1" class="headerlink" title="Filtering and searching"></a>Filtering and searching</h5><p>The Groovy development kit contains filtering, searching and collecting methods similar to those found for lists:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> people = [</span><br><span class="line"><span class="symbol">    1:</span> [<span class="string">name:</span><span class="string">'Bob'</span>, <span class="string">age:</span> <span class="number">32</span>, <span class="string">gender:</span> <span class="string">'M'</span>],</span><br><span class="line"><span class="symbol">    2:</span> [<span class="string">name:</span><span class="string">'Johnny'</span>, <span class="string">age:</span> <span class="number">36</span>, <span class="string">gender:</span> <span class="string">'M'</span>],</span><br><span class="line"><span class="symbol">    3:</span> [<span class="string">name:</span><span class="string">'Claire'</span>, <span class="string">age:</span> <span class="number">21</span>, <span class="string">gender:</span> <span class="string">'F'</span>],</span><br><span class="line"><span class="symbol">    4:</span> [<span class="string">name:</span><span class="string">'Amy'</span>, <span class="string">age:</span> <span class="number">54</span>, <span class="string">gender:</span><span class="string">'F'</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> bob = people.find &#123; it.value.name == <span class="string">'Bob'</span> &#125; <span class="comment">// find a single entry</span></span><br><span class="line"><span class="keyword">def</span> females = people.findAll &#123; it.value.gender == <span class="string">'F'</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// both return entries, but you can use collect to retrieve the ages for example</span></span><br><span class="line"><span class="keyword">def</span> ageOfBob = bob.value.age</span><br><span class="line"><span class="keyword">def</span> agesOfFemales = females.collect &#123;</span><br><span class="line">    it.value.age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> ageOfBob == <span class="number">32</span></span><br><span class="line"><span class="keyword">assert</span> agesOfFemales == [<span class="number">21</span>,<span class="number">54</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// but you could also use a key/pair value as the parameters of the closures</span></span><br><span class="line"><span class="keyword">def</span> agesOfMales = people.findAll &#123; id, person -&gt;</span><br><span class="line">    person.gender == <span class="string">'M'</span></span><br><span class="line">&#125;.collect &#123; id, person -&gt;</span><br><span class="line">    person.age</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">assert</span> agesOfMales == [<span class="number">32</span>, <span class="number">36</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// `every` returns true if all entries match the predicate</span></span><br><span class="line"><span class="keyword">assert</span> people.every &#123; id, person -&gt;</span><br><span class="line">    person.age &gt; <span class="number">18</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// `any` returns true if any entry matches the predicate</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> people.any &#123; id, person -&gt;</span><br><span class="line">    person.age == <span class="number">54</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Grouping"><a href="#Grouping" class="headerlink" title="Grouping"></a>Grouping</h5><p>We can group a list into a map using some criteria:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> [<span class="string">'a'</span>, <span class="number">7</span>, <span class="string">'b'</span>, [<span class="number">2</span>, <span class="number">3</span>]].groupBy &#123;</span><br><span class="line">    it.<span class="keyword">class</span></span><br><span class="line">&#125; == [(String)   : [<span class="string">'a'</span>, <span class="string">'b'</span>],</span><br><span class="line">      (Integer)  : [<span class="number">7</span>],</span><br><span class="line">      (ArrayList): [[<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> [</span><br><span class="line">        [<span class="string">name:</span> <span class="string">'Clark'</span>, <span class="string">city:</span> <span class="string">'London'</span>], [<span class="string">name:</span> <span class="string">'Sharma'</span>, <span class="string">city:</span> <span class="string">'London'</span>],</span><br><span class="line">        [<span class="string">name:</span> <span class="string">'Maradona'</span>, <span class="string">city:</span> <span class="string">'LA'</span>], [<span class="string">name:</span> <span class="string">'Zhang'</span>, <span class="string">city:</span> <span class="string">'HK'</span>],</span><br><span class="line">        [<span class="string">name:</span> <span class="string">'Ali'</span>, <span class="string">city:</span> <span class="string">'HK'</span>], [<span class="string">name:</span> <span class="string">'Liu'</span>, <span class="string">city:</span> <span class="string">'HK'</span>],</span><br><span class="line">].groupBy &#123; it.city &#125; == [</span><br><span class="line"><span class="symbol">        London:</span> [[<span class="string">name:</span> <span class="string">'Clark'</span>, <span class="string">city:</span> <span class="string">'London'</span>],</span><br><span class="line">                 [<span class="string">name:</span> <span class="string">'Sharma'</span>, <span class="string">city:</span> <span class="string">'London'</span>]],</span><br><span class="line">        <span class="string">LA    :</span> [[<span class="string">name:</span> <span class="string">'Maradona'</span>, <span class="string">city:</span> <span class="string">'LA'</span>]],</span><br><span class="line">        <span class="string">HK    :</span> [[<span class="string">name:</span> <span class="string">'Zhang'</span>, <span class="string">city:</span> <span class="string">'HK'</span>],</span><br><span class="line">                 [<span class="string">name:</span> <span class="string">'Ali'</span>, <span class="string">city:</span> <span class="string">'HK'</span>],</span><br><span class="line">                 [<span class="string">name:</span> <span class="string">'Liu'</span>, <span class="string">city:</span> <span class="string">'HK'</span>]],</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="Ranges"><a href="#Ranges" class="headerlink" title="Ranges"></a>Ranges</h3><p>Ranges allow you to create a list of sequential values. These can be used as List since Range extends java.util.List.</p>
<p>Ranges defined with the .. notation are inclusive (that is the list contains the from and to value).</p>
<p>Ranges defined with the ..&lt; notation are half-open, they include the first value but not the last value.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// an inclusive range</span></span><br><span class="line"><span class="keyword">def</span> range = <span class="number">5.</span><span class="number">.8</span></span><br><span class="line"><span class="keyword">assert</span> range.size() == <span class="number">4</span></span><br><span class="line"><span class="keyword">assert</span> range.get(<span class="number">2</span>) == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range[<span class="number">2</span>] == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// lets use a half-open range</span></span><br><span class="line">range = <span class="number">5.</span>.&lt;<span class="number">8</span></span><br><span class="line"><span class="keyword">assert</span> range.size() == <span class="number">3</span></span><br><span class="line"><span class="keyword">assert</span> range.get(<span class="number">2</span>) == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range[<span class="number">2</span>] == <span class="number">7</span></span><br><span class="line"><span class="keyword">assert</span> range <span class="keyword">instanceof</span> java.util.List</span><br><span class="line"><span class="keyword">assert</span> range.contains(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">assert</span> !range.contains(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//get the end points of the range without using indexes</span></span><br><span class="line">range = <span class="number">1.</span><span class="number">.10</span></span><br><span class="line"><span class="keyword">assert</span> range.from == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> range.to == <span class="number">10</span></span><br></pre></td></tr></table></figure>
<p>Note that int ranges are implemented efficiently, creating a lightweight Java object containing a from and to value.</p>
<p>Ranges can be used for any Java object which implements java.lang.Comparable for comparison and also have methods next() and previous() to return the next / previous item in the range. For example, you can create a range of String elements:</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Groovy/">Groovy</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/04/08/groovy/groovy集合/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/08/groovy/groovy集合/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/04/08/groovy/groovy数字/" title="groovy数字" itemprop="url">groovy数字</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ming15" target="_blank" itemprop="author">ming15</a>
		
  <p class="article-time">
    <time datetime="2014-04-07T16:00:00.000Z" itemprop="datePublished"> 发表于 2014-04-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <blockquote>
<p>本文是对Groovy部分官方文档进行了翻译</p>
</blockquote>
<p>Groovy支持多种不同的整数字面量和小数字面量 (通过依靠Java数字类型实现)</p>
<h3 id="Integral-literals"><a href="#Integral-literals" class="headerlink" title="Integral literals"></a>Integral literals</h3><p>The integral literal types are the same as in Java:</p>
<p>证书类型变量和Java里的一样</p>
<ul>
<li>byte</li>
<li>char</li>
<li>short</li>
<li>int</li>
<li>long</li>
<li>java.lang.BigInteger</li>
</ul>
<p>You can create integral numbers of those types with the following declarations:</p>
<p>可以通过以下声明方式创建整数类型变量<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// primitive types</span></span><br><span class="line"><span class="keyword">byte</span>  b = <span class="number">1</span></span><br><span class="line"><span class="keyword">char</span>  c = <span class="number">2</span></span><br><span class="line"><span class="keyword">short</span> s = <span class="number">3</span></span><br><span class="line"><span class="keyword">int</span>   i = <span class="number">4</span></span><br><span class="line"><span class="keyword">long</span>  l = <span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// infinite precision</span></span><br><span class="line">BigInteger bi =  <span class="number">6</span></span><br></pre></td></tr></table></figure></p>
<p>如果使用<code>def</code>关键字, 整型类型会发生改变：它会自动适配成能够存储number类型的类型<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> a = <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> a <span class="keyword">instanceof</span> Integer</span><br><span class="line"></span><br><span class="line"><span class="comment">// Integer.MAX_VALUE</span></span><br><span class="line"><span class="keyword">def</span> b = <span class="number">2147483647</span></span><br><span class="line"><span class="keyword">assert</span> b <span class="keyword">instanceof</span> Integer</span><br><span class="line"></span><br><span class="line"><span class="comment">// Integer.MAX_VALUE + 1</span></span><br><span class="line"><span class="keyword">def</span> c = <span class="number">2147483648</span></span><br><span class="line"><span class="keyword">assert</span> c <span class="keyword">instanceof</span> Long</span><br><span class="line"></span><br><span class="line"><span class="comment">// Long.MAX_VALUE</span></span><br><span class="line"><span class="keyword">def</span> d = <span class="number">9223372036854775807</span></span><br><span class="line"><span class="keyword">assert</span> d <span class="keyword">instanceof</span> Long</span><br><span class="line"></span><br><span class="line"><span class="comment">// Long.MAX_VALUE + 1</span></span><br><span class="line"><span class="keyword">def</span> e = <span class="number">9223372036854775808</span></span><br><span class="line"><span class="keyword">assert</span> e <span class="keyword">instanceof</span> BigInteger</span><br></pre></td></tr></table></figure></p>
<p>As well as for negative numbers:<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> na = <span class="number">-1</span></span><br><span class="line"><span class="keyword">assert</span> na <span class="keyword">instanceof</span> Integer</span><br><span class="line"></span><br><span class="line"><span class="comment">// Integer.MIN_VALUE</span></span><br><span class="line"><span class="keyword">def</span> nb = <span class="number">-2147483648</span></span><br><span class="line"><span class="keyword">assert</span> nb <span class="keyword">instanceof</span> Integer</span><br><span class="line"></span><br><span class="line"><span class="comment">// Integer.MIN_VALUE - 1</span></span><br><span class="line"><span class="keyword">def</span> nc = <span class="number">-2147483649</span></span><br><span class="line"><span class="keyword">assert</span> nc <span class="keyword">instanceof</span> Long</span><br><span class="line"></span><br><span class="line"><span class="comment">// Long.MIN_VALUE</span></span><br><span class="line"><span class="keyword">def</span> nd = <span class="number">-9223372036854775808</span></span><br><span class="line"><span class="keyword">assert</span> nd <span class="keyword">instanceof</span> Long</span><br><span class="line"></span><br><span class="line"><span class="comment">// Long.MIN_VALUE - 1</span></span><br><span class="line"><span class="keyword">def</span> ne = <span class="number">-9223372036854775809</span></span><br><span class="line"><span class="keyword">assert</span> ne <span class="keyword">instanceof</span> BigInteger</span><br></pre></td></tr></table></figure></p>
<h4 id="Alternative-non-base-10-representations"><a href="#Alternative-non-base-10-representations" class="headerlink" title="Alternative non-base 10 representations"></a>Alternative non-base 10 representations</h4><h5 id="Binary-literal"><a href="#Binary-literal" class="headerlink" title="Binary literal"></a>Binary literal</h5><p>在Java6以前和Groovy中,number类型可以是小数, 8进制和16进制. 但是在Java7和Groovy2中,可以使用0b前缀表示二进制数据.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> xInt = <span class="number">0b10101111</span></span><br><span class="line"><span class="keyword">assert</span> xInt == <span class="number">175</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">short</span> xShort = <span class="number">0b11001001</span></span><br><span class="line"><span class="keyword">assert</span> xShort == <span class="number">201</span> <span class="keyword">as</span> <span class="keyword">short</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">byte</span> xByte = <span class="number">0b11</span></span><br><span class="line"><span class="keyword">assert</span> xByte == <span class="number">3</span> <span class="keyword">as</span> <span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> xLong = <span class="number">0b101101101101</span></span><br><span class="line"><span class="keyword">assert</span> xLong == <span class="number">2925</span>l</span><br><span class="line"></span><br><span class="line">BigInteger xBigInteger = <span class="number">0b111100100001</span></span><br><span class="line"><span class="keyword">assert</span> xBigInteger == <span class="number">3873</span>g</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> xNegativeInt = <span class="number">-0</span>b10101111</span><br><span class="line"><span class="keyword">assert</span> xNegativeInt == <span class="number">-175</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Octal-literal"><a href="#Octal-literal" class="headerlink" title="Octal literal"></a>Octal literal</h5><p>8进制的电话,只需要开头是0后跟要表示的8进制数即可.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> xInt = <span class="number">077</span></span><br><span class="line"><span class="keyword">assert</span> xInt == <span class="number">63</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">short</span> xShort = <span class="number">011</span></span><br><span class="line"><span class="keyword">assert</span> xShort == <span class="number">9</span> <span class="keyword">as</span> <span class="keyword">short</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">byte</span> xByte = <span class="number">032</span></span><br><span class="line"><span class="keyword">assert</span> xByte == <span class="number">26</span> <span class="keyword">as</span> <span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> xLong = <span class="number">0246</span></span><br><span class="line"><span class="keyword">assert</span> xLong == <span class="number">166</span>l</span><br><span class="line"></span><br><span class="line">BigInteger xBigInteger = <span class="number">01111</span></span><br><span class="line"><span class="keyword">assert</span> xBigInteger == <span class="number">585</span>g</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> xNegativeInt = <span class="number">-077</span></span><br><span class="line"><span class="keyword">assert</span> xNegativeInt == <span class="number">-63</span></span><br></pre></td></tr></table></figure></p>
<h5 id="Hexadecimal-literal"><a href="#Hexadecimal-literal" class="headerlink" title="Hexadecimal literal"></a>Hexadecimal literal</h5><p>Hexadecimal numbers are specified in the typical format of 0x followed by hex digits.</p>
<p>16进制的电话,只需要开头是0x后跟要表示的16进制数即可.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span> xInt = <span class="number">0x77</span></span><br><span class="line"><span class="keyword">assert</span> xInt == <span class="number">119</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">short</span> xShort = <span class="number">0xaa</span></span><br><span class="line"><span class="keyword">assert</span> xShort == <span class="number">170</span> <span class="keyword">as</span> <span class="keyword">short</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">byte</span> xByte = <span class="number">0x3a</span></span><br><span class="line"><span class="keyword">assert</span> xByte == <span class="number">58</span> <span class="keyword">as</span> <span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> xLong = <span class="number">0xffff</span></span><br><span class="line"><span class="keyword">assert</span> xLong == <span class="number">65535</span>l</span><br><span class="line"></span><br><span class="line">BigInteger xBigInteger = <span class="number">0xaaaa</span></span><br><span class="line"><span class="keyword">assert</span> xBigInteger == <span class="number">43690</span>g</span><br><span class="line"></span><br><span class="line">Double xDouble = <span class="keyword">new</span> Double(<span class="string">'0x1.0p0'</span>)</span><br><span class="line"><span class="keyword">assert</span> xDouble == <span class="number">1.0</span>d</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> xNegativeInt = <span class="number">-0x77</span></span><br><span class="line"><span class="keyword">assert</span> xNegativeInt == <span class="number">-119</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Decimal-literals"><a href="#Decimal-literals" class="headerlink" title="Decimal literals"></a>Decimal literals</h3><p>小数字面量和在java 里一样</p>
<ul>
<li>float</li>
<li>double</li>
<li>java.lang.BigDecimal</li>
</ul>
<p>可以通过下面的方式创建小数类型的number<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// primitive types</span></span><br><span class="line"><span class="keyword">float</span>  f = <span class="number">1.234</span></span><br><span class="line"><span class="keyword">double</span> d = <span class="number">2.345</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// infinite precision</span></span><br><span class="line">BigDecimal bd =  <span class="number">3.456</span></span><br></pre></td></tr></table></figure></p>
<p>Decimals can use exponents, with the e or E exponent letter, followed by an optional sign, and a integral number representing the exponent:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="number">1e3</span>  ==  <span class="number">1</span>_000<span class="number">.0</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">2E4</span>  == <span class="number">20</span>_000<span class="number">.0</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">3e+1</span> ==     <span class="number">30.0</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">4E-2</span> ==      <span class="number">0.04</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">5e-1</span> ==      <span class="number">0.5</span></span><br></pre></td></tr></table></figure>
<p>Conveniently for exact decimal number calculations, Groovy choses java.lang.BigDecimal as its decimal number type. In addition, both float and double are supported, but require an explicit type declaration, type coercion or suffix. Even if BigDecimal is the default for decimal numbers, such literals are accepted in methods or closures taking float or double as parameter types.</p>
<p>Decimal numbers can’t be represented using a binary, octal or hexadecimal representation.</p>
<h3 id="Underscore-in-literals"><a href="#Underscore-in-literals" class="headerlink" title="Underscore in literals"></a>Underscore in literals</h3><p>When writing long literal numbers, it’s harder on the eye to figure out how some numbers are grouped together, for example with groups of thousands, of words, etc. By allowing you to place underscore in number literals, it’s easier to spot those groups:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> creditCardNumber = <span class="number">1234</span>_5678_9012_3456L</span><br><span class="line"><span class="keyword">long</span> socialSecurityNumbers = <span class="number">999</span>_99_9999L</span><br><span class="line"><span class="keyword">double</span> monetaryAmount = <span class="number">12</span>_345_132<span class="number">.12</span></span><br><span class="line"><span class="keyword">long</span> hexBytes = <span class="number">0xFF</span>_EC_DE_5E</span><br><span class="line"><span class="keyword">long</span> hexWords = <span class="number">0xFFEC</span>_DE5E</span><br><span class="line"><span class="keyword">long</span> maxLong = <span class="number">0x7fff</span>_ffff_ffff_ffffL</span><br><span class="line"><span class="keyword">long</span> alsoMaxLong = <span class="number">9</span>_223_372_036_854_775_807L</span><br><span class="line"><span class="keyword">long</span> bytes = <span class="number">0b11010010</span>_01101001_10010100_10010010</span><br></pre></td></tr></table></figure>
<h3 id="Number-type-suffixes"><a href="#Number-type-suffixes" class="headerlink" title="Number type suffixes"></a>Number type suffixes</h3><p>我们可以通过添加后缀的方式强制指定一个数字的类型(包含二进制,八进制和十六进制)<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Type			Suffix</span><br><span class="line">BigInteger		G or g</span><br><span class="line">Long			L or l</span><br><span class="line">Integer			I or i</span><br><span class="line">BigDecimal		G or g</span><br><span class="line">Double			D or d</span><br><span class="line">Float			F or f</span><br></pre></td></tr></table></figure></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="number">42</span>I == <span class="keyword">new</span> Integer(<span class="string">'42'</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">42</span>i == <span class="keyword">new</span> Integer(<span class="string">'42'</span>) <span class="comment">// lowercase i more readable</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">123</span>L == <span class="keyword">new</span> Long(<span class="string">"123"</span>) <span class="comment">// uppercase L more readable</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">2147483648</span> == <span class="keyword">new</span> Long(<span class="string">'2147483648'</span>) <span class="comment">// Long type used, value too large for an Integer</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">456</span>G == <span class="keyword">new</span> BigInteger(<span class="string">'456'</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">456</span>g == <span class="keyword">new</span> BigInteger(<span class="string">'456'</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">123.45</span> == <span class="keyword">new</span> BigDecimal(<span class="string">'123.45'</span>) <span class="comment">// default BigDecimal type used</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">1.200065</span>D == <span class="keyword">new</span> Double(<span class="string">'1.200065'</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">1.234</span>F == <span class="keyword">new</span> Float(<span class="string">'1.234'</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">1.23E23</span>D == <span class="keyword">new</span> Double(<span class="string">'1.23E23'</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="number">0b1111</span>L.<span class="keyword">class</span> == Long <span class="comment">// binary</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">0xFF</span>i.<span class="keyword">class</span> == Integer <span class="comment">// hexadecimal</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">034</span>G.<span class="keyword">class</span> == BigInteger <span class="comment">// octal</span></span><br></pre></td></tr></table></figure>
<h3 id="Math-operations"><a href="#Math-operations" class="headerlink" title="Math operations"></a>Math operations</h3><p>尽管接下来我们还要详细讨论操作符, 但是鉴于数学操作符的重要性, 现在我们还是要先讨论其行为和返回类型</p>
<ul>
<li>byte, char, short 和 int 之间的二进制计算返回的是int类型</li>
<li>byte, char, short 和 int 之间的二进制计算中涉及到long的话, 那么返回的就是long类型</li>
<li>BigInteger 与任何整数类型的二进制计算 返回的结果都是BigInteger类型</li>
<li>float, double 和 BigDecimal 之间的二进制计算返回的结果都是double类型</li>
<li>俩个BigDecimal之间的二进制运算返回的都是BigDecimal类型.</li>
</ul>
<p>由于Groovy提供了操作符重载功能, BigInteger和BigDecimal之间的算术运算也得以实现, 但是在Java中需要调用一些方法才能计算这些不同类型的数字.</p>
<h4 id="The-case-of-the-power-operator"><a href="#The-case-of-the-power-operator" class="headerlink" title="The case of the power operator"></a>The case of the power operator</h4><p>Groovy 里有一种强大的操作符<code>**</code>, 这个操作符带有base和exponent俩个参数. 这个操作符的结果依赖于它的操作数和操作结果.Groovy使用下面的规则来决定该操作符的返回类型</p>
<h5 id="如果exponent为小数类型"><a href="#如果exponent为小数类型" class="headerlink" title="如果exponent为小数类型"></a>如果exponent为小数类型</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>. 如果结果能表示为Integer类型,那就返回Integer类型</span><br><span class="line"><span class="number">2</span>. 否则如果结果能表示为Long类型,那就返回Long类型</span><br><span class="line"><span class="number">3</span>. 否则的话就返回Double</span><br></pre></td></tr></table></figure>
<h5 id="如果exponent为整数类型"><a href="#如果exponent为整数类型" class="headerlink" title="如果exponent为整数类型"></a>如果exponent为整数类型</h5><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 如果exponent负数负数, 那就返回Integer, Long 或者Double,</span><br><span class="line"><span class="number">2.</span> 如果exponent是正数或者<span class="number">0</span>, 那就要根据base来判断了</span><br><span class="line">	A. 如果base是 BigDecimal, 那就返回BigDecimal类型</span><br><span class="line">	B. 如果base是 BigInteger, 那就返回BigInteger类型</span><br><span class="line">	C. 如果base是 Integer, 那就返回Integer类型, 如果返回的值超过Integer范围的话,就返回BigInteger</span><br><span class="line">	D. 如果base是 Long, 那就返回Long类型, 如果返回的值超过Long范围的话,就返回BigInteger</span><br></pre></td></tr></table></figure>
<h5 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h5><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// base and exponent are ints and the result can be represented by an Integer</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">2</span>    **   <span class="number">3</span>    <span class="keyword">instanceof</span> Integer    <span class="comment">//  8</span></span><br><span class="line"><span class="keyword">assert</span>   <span class="number">10</span>    **   <span class="number">9</span>    <span class="keyword">instanceof</span> Integer    <span class="comment">//  1_000_000_000</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the base is a long, so fit the result in a Long</span></span><br><span class="line"><span class="comment">// (although it could have fit in an Integer)</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">5</span>L   **   <span class="number">2</span>    <span class="keyword">instanceof</span> Long       <span class="comment">//  25</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the result can't be represented as an Integer or Long, so return a BigInteger</span></span><br><span class="line"><span class="keyword">assert</span>  <span class="number">100</span>    **  <span class="number">10</span>    <span class="keyword">instanceof</span> BigInteger <span class="comment">//  10e20</span></span><br><span class="line"><span class="keyword">assert</span> <span class="number">1234</span>    ** <span class="number">123</span>    <span class="keyword">instanceof</span> BigInteger <span class="comment">//  170515806212727042875...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the base is a BigDecimal and the exponent a negative int</span></span><br><span class="line"><span class="comment">// but the result can be represented as an Integer</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">0.5</span>  **  <span class="number">-2</span>    <span class="keyword">instanceof</span> Integer    <span class="comment">//  4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the base is an int, and the exponent a negative float</span></span><br><span class="line"><span class="comment">// but again, the result can be represented as an Integer</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">1</span>    **  <span class="number">-0.3</span>f <span class="keyword">instanceof</span> Integer    <span class="comment">//  1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the base is an int, and the exponent a negative int</span></span><br><span class="line"><span class="comment">// but the result will be calculated as a Double</span></span><br><span class="line"><span class="comment">// (both base and exponent are actually converted to doubles)</span></span><br><span class="line"><span class="keyword">assert</span>   <span class="number">10</span>    **  <span class="number">-1</span>    <span class="keyword">instanceof</span> Double     <span class="comment">//  0.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the base is a BigDecimal, and the exponent is an int, so return a BigDecimal</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">1.2</span>  **  <span class="number">10</span>    <span class="keyword">instanceof</span> BigDecimal <span class="comment">//  6.1917364224</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the base is a float or double, and the exponent is an int</span></span><br><span class="line"><span class="comment">// but the result can only be represented as a Double value</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">3.4</span>f **   <span class="number">5</span>    <span class="keyword">instanceof</span> Double     <span class="comment">//  454.35430372146965</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">5.6</span>d **   <span class="number">2</span>    <span class="keyword">instanceof</span> Double     <span class="comment">//  31.359999999999996</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// the exponent is a decimal value</span></span><br><span class="line"><span class="comment">// and the result can only be represented as a Double value</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">7.8</span>  **   <span class="number">1.9</span>  <span class="keyword">instanceof</span> Double     <span class="comment">//  49.542708423868476</span></span><br><span class="line"><span class="keyword">assert</span>    <span class="number">2</span>    **   <span class="number">0.1</span>f <span class="keyword">instanceof</span> Double     <span class="comment">//  1.0717734636432956</span></span><br></pre></td></tr></table></figure>
<h2 id="Booleans"><a href="#Booleans" class="headerlink" title="Booleans"></a>Booleans</h2><p>Boolean是一种特殊的数据类型, 他们的值只有俩种情况：true 和 false.<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> myBooleanVariable = <span class="literal">true</span></span><br><span class="line"><span class="keyword">boolean</span> untypedBooleanVar = <span class="literal">false</span></span><br><span class="line">booleanField = <span class="literal">true</span></span><br></pre></td></tr></table></figure></p>
<p>true and false are the only two primitive boolean values. But more complex boolean expressions can be represented using logical operators.</p>
<p>In addition, Groovy has special rules (often referred to as Groovy Truth) for coercing non-boolean objects to a boolean value.</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Groovy/">Groovy</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2014/04/08/groovy/groovy数字/#comments" class="ds-thread-count comments-count-link" data-thread-key="2014/04/08/groovy/groovy数字/" data-count-type="comments">&nbsp;</a>
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/15/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/17/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="ming15" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Groovy/" title="Groovy">Groovy<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Haskell/" title="Haskell">Haskell<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/JMH/" title="JMH">JMH<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/JVM/" title="JVM">JVM<sup>14</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaSE/" title="JavaSE">JavaSE<sup>28</sup></a></li>
		  
		
		  
			<li><a href="/categories/JavaScript/" title="JavaScript">JavaScript<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java工具/" title="Java工具">Java工具<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/MongoDB/" title="MongoDB">MongoDB<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Netty/" title="Netty">Netty<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/Nginx/" title="Nginx">Nginx<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/Php/" title="Php">Php<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Reids/" title="Reids">Reids<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/TCP-IP/" title="TCP IP">TCP IP<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/ZooKeeper/" title="ZooKeeper">ZooKeeper<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/asm/" title="asm">asm<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/guice/" title="guice">guice<sup>8</sup></a></li>
		  
		
		  
			<li><a href="/categories/http客户端/" title="http客户端">http客户端<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/http服务器/" title="http服务器">http服务器<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/" title="linux">linux<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/memcached/" title="memcached">memcached<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/mgits/" title="mgits">mgits<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/mycat/" title="mycat">mycat<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/python2/" title="python2">python2<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/并发编程/" title="并发编程">并发编程<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/序列化工具/" title="序列化工具">序列化工具<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/操作系统/" title="操作系统">操作系统<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/数据库/" title="数据库">数据库<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/日志工具/" title="日志工具">日志工具<sup>7</sup></a></li>
		  
		
		  
			<li><a href="/categories/构建工具/" title="构建工具">构建工具<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>1</sup></a></li>
		  
		
		</ul>
</div>


  

  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://www1.vertx3.cn" target="_blank" title="vertx3">vertx3</a>
            
          </li>
        
    </ul>
</div>

  

<div class="doubanshow">
<p class="asidetitle">豆瓣秀</p>
<div>
<script type="text/javascript" src="http://www.douban.com/service/badge/xxxyy/?show=collection&amp;n=12&amp;columns=3&amp;hidelogo=yes&amp;hideself=yes&amp;cat=book|movie" ></script>
</div>
</div>


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">新浪微博</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=3253370782&verifier=e9ca895b&dpc=1"></iframe>
</div>


  

<div class="lofter">
<p class="asidetitle">Lofter</p>

 <iframe width="100%" height="39" class="share_self"  frameborder="0" scrolling="no" src="http://ming15.lofter.com/"></iframe>
</div>




</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 博客,我选择重构 <br/>
			重构使事情变得更美,更加正确</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/3253370782" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/ming15" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		<a href="https://www.douban.com/people/xxxyy" target="_blank" class="icon-douban" title="豆瓣"></a>
		
		
		<a href="http://www.zhihu.com/people/ming15" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="ming15">ming15</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"wanggnim"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 







<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F9e8fca440159a2125668804e46682db4' type='text/javascript'%3E%3C/script%3E"));
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
